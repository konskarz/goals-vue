import{b as Q}from"./use-dark-ab69c230.js";import{Q as B}from"./QToggle-fda05048.js";import{j as U,Q as t,R as u,S as c,T as r,U as b,r as D,w as P,V as q,a4 as l,a2 as f,a7 as S,ae as $,a5 as I}from"./index-82773c7f.js";import{Q as k,a as Y}from"./QForm-e1f27c21.js";import{u as H,M as K,d as F}from"./MainPage-0202bc80.js";import{u as G,_ as y}from"./DateInput-f312b9cb.js";import{_ as R}from"./GoalSelect-b301f021.js";import"./use-field-51305d66.js";import"./uid-6a237b22.js";import"./format-8c778330.js";import"./QSlideTransition-782458ae.js";import"./use-timeout-90e9a518.js";import"./use-model-toggle-6bc55501.js";const w={__name:"NumberInput",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(g,{emit:T}){const s=g,e=U({get(){return s.modelValue},set(V){V>=0&&T("update:modelValue",V)}});return(V,d)=>(t(),u(k,{modelValue:e.value,"onUpdate:modelValue":d[2]||(d[2]=i=>e.value=i),modelModifiers:{number:!0},type:"number",min:"0","stack-label":""},{append:c(()=>[r(b,{round:"",label:"-1",onClick:d[0]||(d[0]=i=>e.value--)}),r(b,{round:"",label:"+1",onClick:d[1]||(d[1]=i=>e.value++)})]),_:1},8,["modelValue"]))}},j={class:"row q-col-gutter-lg"},oe={__name:"TaskView",props:{id:{type:String,required:!0}},setup(g){const s=parseInt(g.id),{item:e,original:V,path:d,persist:i,changed:N,remove:_,save:x,back:C}=G(s,H(),{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),m=D(!1),M=U(()=>!e.value.name||i.value||!!(s&&!N(V,{...e.value}))),v=U(()=>{const n=e.value.performance_history;if(!n||!n.length)return null;const o=p=>F.formatDate(p.updated,"DD.MM.YYYY HH:mm")+" to "+p.value;let a=o(n[0]);if(n.length===1)return a;for(let p=1;p<n.length;p++)a+=", "+o(n[p]);return a});return P(m,n=>{d.value=n?"recurring/"+e.value.group_id+"/":s+"/"}),(n,o)=>(t(),u(K,null,{toolbar:c(()=>[m.value?(t(),u(Q,{key:1},{default:c(()=>[q("Group")]),_:1})):(t(),u(Q,{key:0},{default:c(()=>[q("Task")]),_:1})),l(e).group_id?(t(),u(B,{key:2,modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=a=>m.value=a),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):f("",!0),l(s)?(t(),u(b,{key:3,flat:"",round:"",icon:"delete",disable:l(i),onClick:l(_)},null,8,["disable","onClick"])):f("",!0),r(b,{flat:"",round:"",icon:"save",disable:M.value,onClick:l(x)},null,8,["disable","onClick"]),r(b,{flat:"",round:"",icon:"clear",onClick:l(C)},null,8,["onClick"])]),default:c(()=>[r(Y,{class:"q-pt-sm q-px-lg",onSubmit:I(l(x),["prevent"])},{default:c(()=>[S("div",j,[r(k,{modelValue:l(e).name,"onUpdate:modelValue":o[1]||(o[1]=a=>l(e).name=a),label:"Name","stack-label":"",autofocus:!l(s),rules:[a=>!!a||"Field is required"],class:"col-12 col-sm-6",onKeyup:$(l(C),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),r(R,{modelValue:l(e).goal,"onUpdate:modelValue":o[2]||(o[2]=a=>l(e).goal=a),label:"Goal","stack-label":"",class:"col-12 col-sm-6"},null,8,["modelValue"]),m.value?f("",!0):(t(),u(y,{key:0,modelValue:l(e).planned,"onUpdate:modelValue":o[3]||(o[3]=a=>l(e).planned=a),label:"Planned",class:"col-12 col-sm-6"},null,8,["modelValue"])),l(s)?(t(),u(y,{key:1,modelValue:l(e).done,"onUpdate:modelValue":o[4]||(o[4]=a=>l(e).done=a),label:"Done",class:"col-12 col-sm-6"},null,8,["modelValue"])):(t(),u(y,{key:2,modelValue:l(e).recurring_until,"onUpdate:modelValue":o[5]||(o[5]=a=>l(e).recurring_until=a),label:"Recurring until",class:"col-12 col-sm-6"},null,8,["modelValue"])),r(w,{modelValue:l(e).target,"onUpdate:modelValue":o[6]||(o[6]=a=>l(e).target=a),label:"Target",class:"col-12 col-sm-6"},null,8,["modelValue"]),m.value?f("",!0):(t(),u(w,{key:3,modelValue:l(e).performance,"onUpdate:modelValue":o[7]||(o[7]=a=>l(e).performance=a),label:"Performance",class:"col-12 col-sm-6"},null,8,["modelValue"]))]),r(k,{modelValue:l(e).description,"onUpdate:modelValue":o[8]||(o[8]=a=>l(e).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),v.value&&!m.value?(t(),u(k,{key:0,modelValue:v.value,"onUpdate:modelValue":o[9]||(o[9]=a=>v.value=a),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):f("",!0)]),_:1},8,["onSubmit"])]),_:1}))}};export{oe as default};
