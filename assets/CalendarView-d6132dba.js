import{b as h,a as M,Q as V}from"./api.client-4da4a93f.js";import{r as v,f as F,o as x,w as I,Z as f,_ as m,a2 as r,a3 as c,a5 as B,a4 as C,ai as u,a6 as g,a7 as E,a8 as y,aj as k}from"./index-4981ecda.js";import{Q as G,_ as L}from"./WeekTimelineEntry-27f11708.js";import{Q as N}from"./QPage-b14f6f2a.js";import{d as e}from"./date-68b99150.js";import{_ as O}from"./GoalSelect-aa9ccaf4.js";import"./QList-29b44268.js";import"./format-da124aa6.js";import"./QItemLabel-cdd93cd8.js";import"./NumberInput-18522579.js";import"./DurationInput-4ff3c3f4.js";import"./selection-b5bb2014.js";const J={__name:"CalendarView",setup(S){const i="Goal-Filter",w=e.formatDate(new Date,"YYYY-w"),l=v(null),{data:_,mutate:T}=h.read("/tasks/"),D=F(()=>{const a=_.value.length,o=a?[..._.value].sort((d,b)=>Date.parse(d.planned)-Date.parse(b.planned)):null,t=a?new Date(o[0].planned):new Date,n=a?new Date(o[o.length-1].planned):e.addToDate(t,{days:7}),Y=e.addToDate(n,{days:7});let s=e.subtractFromDate(t,{days:e.getDayOfWeek(t)-1});const Q=e.subtractFromDate(Y,{days:e.getDayOfWeek(Y)-1});let p={};for(;s<=Q;)p[e.formatDate(s,"YYYY-w")]={day:e.formatDate(s,"YYYY-MM-DD"),tasks:[]},s=e.addToDate(s,{days:7});return a&&o.forEach(d=>{p[e.formatDate(d.planned,"YYYY-w")].tasks.push(d)}),p});return x(()=>{const a=localStorage.getItem(i);a&&(l.value=parseInt(a))}),I(l,a=>{a?localStorage.setItem(i,a):localStorage.removeItem(i)}),(a,o)=>(r(),f(N,{padding:""},{default:m(()=>[c(V,null,{default:m(()=>[c(M,null,{default:m(()=>[B("Tasks")]),_:1}),c(O,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),label:"For Goal",dense:"",borderless:"",class:"col-6 col-sm-3 col-lg-2"},null,8,["modelValue"]),c(C,{to:{name:"task",params:{id:"create"}},icon:"assignment_add",flat:"",round:""})]),_:1}),u(D)?(r(),f(G,{key:0,layout:"dense",class:"q-px-md"},{default:m(()=>[(r(!0),g(y,null,E(u(D),(t,n)=>(r(),g(y,{key:n},[t.day?(r(),f(L,{key:0,color:n===u(w)?"orange":"",week:t,onMutate:u(T)},null,8,["color","week","onMutate"])):k("",!0)],64))),128))]),_:1})):k("",!0)]),_:1}))}};export{J as default};
