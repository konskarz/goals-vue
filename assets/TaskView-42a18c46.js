import{Q as B,c as D}from"./uid-5aea0a88.js";import{Q as S}from"./QToggle-15e843c0.js";import{j as U,P as r,R as s,S as V,T as u,a4 as f,W as e,ac as C,a1 as I,r as M,w as R,U as Y,$ as c,ad as q,ae as H,a8 as K}from"./index-11efb6b3.js";import{Q as g,a as F}from"./QForm-6dee6b6a.js";import{Q as j,_ as G}from"./GoalSelect-ce5e32d2.js";import{u as W,d as z}from"./TaskStore-596d80e7.js";import{u as A,_ as T}from"./DateInput-c1623348.js";import"./use-field-676410fa.js";import"./QSlideTransition-4ae2367c.js";const _={__name:"NumberInput",props:{label:{type:String,required:!0},modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(k,{emit:y}){const v=k,t=U({get(){return v.modelValue},set(l){l>=0&&y("update:modelValue",l)}});return(l,d)=>(r(),s(g,{modelValue:e(t),"onUpdate:modelValue":d[2]||(d[2]=i=>C(t)?t.value=i:null),modelModifiers:{number:!0},type:"number",min:"0",label:k.label,"stack-label":""},{append:V(()=>[u(f,{round:"",label:"-1",onClick:d[0]||(d[0]=i=>t.value--)}),u(f,{round:"",label:"+1",onClick:d[1]||(d[1]=i=>t.value++)})]),_:1},8,["modelValue","label"]))}},E={class:"q-px-lg q-py-sm"},J={class:"row q-col-gutter-lg"},te={__name:"TaskView",setup(k){const y=I(),v=W(),t=parseInt(y.params.id),{item:l,original:d,path:i,persist:Q,changed:w,remove:N,save:P,back:x}=A(t,v,{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),p=M(!1),$=U(()=>!l.value.name||Q.value||!!(t&&!w(d,{...l.value}))),b=U(()=>{const n=l.value.performance_history;if(!n||!n.length)return null;const o=m=>z.formatDate(m.updated,"DD.MM.YYYY HH:mm")+" to "+m.value;let a=o(n[0]);if(n.length===1)return a;for(let m=1;m<n.length;m++)a+=", "+o(n[m]);return a});return R(p,n=>{i.value=n?"recurring/"+l.value.group_id+"/":t+"/"}),(n,o)=>(r(),s(j,null,{default:V(()=>[u(F,{onSubmit:K(e(P),["prevent"])},{default:V(()=>[u(B,{class:"q-mt-md q-pl-lg"},{default:V(()=>[u(D,null,{default:V(()=>[Y("Task")]),_:1}),e(l).group_id?(r(),s(S,{key:0,modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=a=>p.value=a),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):c("",!0),e(t)?(r(),s(f,{key:1,type:"button",flat:"",round:"",icon:"delete",disable:e(Q),onClick:e(N)},null,8,["disable","onClick"])):c("",!0),u(f,{type:"submit",flat:"",round:"",icon:"save",disable:e($)},null,8,["disable"]),u(f,{type:"button",flat:"",round:"",icon:"clear",onClick:e(x)},null,8,["onClick"])]),_:1}),q("div",E,[q("div",J,[u(g,{modelValue:e(l).name,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(t),rules:[a=>!!a||"Field is required"],class:"col-12 col-lg-6",onKeyup:H(e(x),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),u(G,{modelValue:e(l).goal,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-lg-6"},null,8,["modelValue"]),p.value?c("",!0):(r(),s(T,{key:0,modelValue:e(l).planned,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).planned=a),label:"Planned",class:"col-12 col-lg-6"},null,8,["modelValue"])),e(t)?(r(),s(T,{key:1,modelValue:e(l).done,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).done=a),label:"Done",class:"col-12 col-lg-6"},null,8,["modelValue"])):(r(),s(T,{key:2,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-lg-6"},null,8,["modelValue"])),u(_,{modelValue:e(l).target,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).target=a),label:"Target",class:"col-12 col-lg-6"},null,8,["modelValue"]),p.value?c("",!0):(r(),s(_,{key:3,modelValue:e(l).performance,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-lg-6"},null,8,["modelValue"]))]),u(g,{modelValue:e(l).description,"onUpdate:modelValue":o[8]||(o[8]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(b)?(r(),s(g,{key:0,modelValue:e(b),"onUpdate:modelValue":o[9]||(o[9]=a=>C(b)?b.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):c("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{te as default};
