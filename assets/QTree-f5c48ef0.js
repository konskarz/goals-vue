import{r as N,j as f,h as o,g as re,ad as be,D as ke,G as ge,ac as ye,at as F,z as Q,c as ie,$ as Z,au as xe,w as ne,b as _e,av as me,aw as qe,E as Se,a8 as Ce,aj as ae}from"./index-d562371e.js";import{a as ce,u as ue}from"./use-dark-9075cea9.js";import{u as Te,a as Ke}from"./use-form-a8612c39.js";import{Q as we}from"./QSlideTransition-ffdb3fab.js";function Ve(l,y){const n=N(null),m=f(()=>l.disable===!0?null:o("span",{ref:n,class:"no-outline",tabindex:-1}));function x(_){const b=y.value;_!==void 0&&_.type.indexOf("key")===0?b!==null&&document.activeElement!==b&&b.contains(document.activeElement)===!0&&b.focus():n.value!==null&&(_===void 0||b!==null&&b.contains(_.target)===!0)&&n.value.focus()}return{refocusTargetEl:m,refocusTarget:x}}const $e={xs:30,sm:35,md:40,lg:50,xl:60},Ae={...ue,...ye,...Te,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:l=>l==="tf"||l==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},Ee=["update:modelValue"];function Ie(l,y){const{props:n,slots:m,emit:x,proxy:_}=re(),{$q:b}=_,C=ce(n,b),q=N(null),{refocusTargetEl:K,refocusTarget:R}=Ve(n,q),O=be(n,$e),T=f(()=>n.val!==void 0&&Array.isArray(n.modelValue)),w=f(()=>{const c=F(n.val);return T.value===!0?n.modelValue.findIndex(S=>F(S)===c):-1}),k=f(()=>T.value===!0?w.value>-1:F(n.modelValue)===F(n.trueValue)),V=f(()=>T.value===!0?w.value===-1:F(n.modelValue)===F(n.falseValue)),P=f(()=>k.value===!1&&V.value===!1),g=f(()=>n.disable===!0?-1:n.tabindex||0),$=f(()=>`q-${l} cursor-pointer no-outline row inline no-wrap items-center`+(n.disable===!0?" disabled":"")+(C.value===!0?` q-${l}--dark`:"")+(n.dense===!0?` q-${l}--dense`:"")+(n.leftLabel===!0?" reverse":"")),D=f(()=>{const c=k.value===!0?"truthy":V.value===!0?"falsy":"indet",S=n.color!==void 0&&(n.keepColor===!0||(l==="toggle"?k.value===!0:V.value!==!0))?` text-${n.color}`:"";return`q-${l}__inner relative-position non-selectable q-${l}__inner--${c}${S}`}),H=f(()=>{const c={type:"checkbox"};return n.name!==void 0&&Object.assign(c,{".checked":k.value,"^checked":k.value===!0?"checked":void 0,name:n.name,value:T.value===!0?n.val:n.trueValue}),c}),U=Ke(H),G=f(()=>{const c={tabindex:g.value,role:l==="toggle"?"switch":"checkbox","aria-label":n.label,"aria-checked":P.value===!0?"mixed":k.value===!0?"true":"false"};return n.disable===!0&&(c["aria-disabled"]="true"),c});function A(c){c!==void 0&&(Q(c),R(c)),n.disable!==!0&&x("update:modelValue",B(),c)}function B(){if(T.value===!0){if(k.value===!0){const c=n.modelValue.slice();return c.splice(w.value,1),c}return n.modelValue.concat([n.val])}if(k.value===!0){if(n.toggleOrder!=="ft"||n.toggleIndeterminate===!1)return n.falseValue}else if(V.value===!0){if(n.toggleOrder==="ft"||n.toggleIndeterminate===!1)return n.trueValue}else return n.toggleOrder!=="ft"?n.trueValue:n.falseValue;return n.indeterminateValue}function L(c){(c.keyCode===13||c.keyCode===32)&&Q(c)}function J(c){(c.keyCode===13||c.keyCode===32)&&A(c)}const E=y(k,P);return Object.assign(_,{toggle:A}),()=>{const c=E();n.disable!==!0&&U(c,"unshift",` q-${l}__native absolute q-ma-none q-pa-none`);const S=[o("div",{class:D.value,style:O.value,"aria-hidden":"true"},c)];K.value!==null&&S.push(K.value);const j=n.label!==void 0?ke(m.default,[n.label]):ge(m.default);return j!==void 0&&S.push(o("div",{class:`q-${l}__label q-anchor--skip`},j)),o("div",{ref:q,class:$.value,...G.value,onClick:A,onKeydown:L,onKeyup:J},S)}}const ze=o("div",{key:"svg",class:"q-checkbox__bg absolute"},[o("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[o("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),o("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Fe=ie({name:"QCheckbox",props:Ae,emits:Ee,setup(l){function y(n,m){const x=f(()=>(n.value===!0?l.checkedIcon:m.value===!0?l.indeterminateIcon:l.uncheckedIcon)||null);return()=>x.value!==null?[o("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[o(Z,{class:"q-checkbox__icon",name:x.value})])]:[ze]}return Ie("checkbox",y)}}),Be=["none","strict","leaf","leaf-filtered"],je=ie({name:"QTree",props:{...ue,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>Be.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:y,emit:n}){const{proxy:m}=re(),{$q:x}=m,_=ce(l,x),b=N({}),C=N(l.ticked||[]),q=N(l.expanded||[]);let K={};xe(()=>{K={}});const R=f(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(_.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),O=f(()=>l.selected!==void 0),T=f(()=>l.icon||x.iconSet.tree.icon),w=f(()=>l.controlColor||l.color),k=f(()=>l.textColor!==void 0?` text-${l.textColor}`:""),V=f(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),P=f(()=>l.filterMethod!==void 0?l.filterMethod:(t,a)=>{const e=a.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)>-1}),g=f(()=>{const t={},a=(e,i)=>{const r=e.tickStrategy||(i?i.tickStrategy:l.tickStrategy),d=e[l.nodeKey],s=e[l.childrenKey]&&Array.isArray(e[l.childrenKey])&&e[l.childrenKey].length!==0,I=e.disabled!==!0&&O.value===!0&&e.selectable!==!1,h=e.disabled!==!0&&e.expandable!==!1,ve=r!=="none",M=r==="strict",te=r==="leaf-filtered",X=r==="leaf"||r==="leaf-filtered";let Y=e.disabled!==!0&&e.tickable!==!1;X===!0&&Y===!0&&i&&i.tickable!==!0&&(Y=!1);let z=e.lazy;z===!0&&b.value[d]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(z=b.value[d]);const u={key:d,parent:i,isParent:s,lazy:z,disabled:e.disabled,link:e.disabled!==!0&&(I===!0||h===!0&&(s===!0||z===!0)),children:[],matchesFilter:l.filter?P.value(e,l.filter):!0,selected:d===l.selected&&I===!0,selectable:I,expanded:s===!0?q.value.includes(d):!1,expandable:h,noTick:e.noTick===!0||M!==!0&&z&&z!=="loaded",tickable:Y,tickStrategy:r,hasTicking:ve,strictTicking:M,leafFilteredTicking:te,leafTicking:X,ticked:M===!0?C.value.includes(d):s===!0?!1:C.value.includes(d)};if(t[d]=u,s===!0&&(u.children=e[l.childrenKey].map(v=>a(v,u)),l.filter&&(u.matchesFilter!==!0?u.matchesFilter=u.children.some(v=>v.matchesFilter):u.noTick!==!0&&u.disabled!==!0&&u.tickable===!0&&te===!0&&u.children.every(v=>v.matchesFilter!==!0||v.noTick===!0||v.tickable!==!0)===!0&&(u.tickable=!1)),u.matchesFilter===!0&&(u.noTick!==!0&&M!==!0&&u.children.every(v=>v.noTick)===!0&&(u.noTick=!0),X))){if(u.ticked=!1,u.indeterminate=u.children.some(v=>v.indeterminate===!0),u.tickable=u.tickable===!0&&u.children.some(v=>v.tickable),u.indeterminate!==!0){const v=u.children.reduce((le,he)=>he.ticked===!0?le+1:le,0);v===u.children.length?u.ticked=!0:v>0&&(u.indeterminate=!0)}u.indeterminate===!0&&(u.indeterminateNextState=u.children.every(v=>v.tickable!==!0||v.ticked!==!0))}return u};return l.nodes.forEach(e=>a(e,null)),t});ne(()=>l.ticked,t=>{C.value=t}),ne(()=>l.expanded,t=>{q.value=t});function $(t){const a=[].reduce,e=(i,r)=>{if(i||!r)return i;if(Array.isArray(r)===!0)return a.call(Object(r),e,i);if(r[l.nodeKey]===t)return r;if(r[l.childrenKey])return e(null,r[l.childrenKey])};return e(null,l.nodes)}function D(){return C.value.map(t=>$(t))}function H(){return q.value.map(t=>$(t))}function U(t){return t&&g.value[t]?g.value[t].expanded:!1}function G(){l.expanded!==void 0?n("update:expanded",[]):q.value=[]}function A(){const t=[],a=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(a))};l.nodes.forEach(a),l.expanded!==void 0?n("update:expanded",t):q.value=t}function B(t,a,e=$(t),i=g.value[t]){if(i.lazy&&i.lazy!=="loaded"){if(i.lazy==="loading")return;b.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),n("lazyLoad",{node:e,key:t,done:r=>{b.value[t]="loaded",e[l.childrenKey]=Array.isArray(r)===!0?r:[],_e(()=>{const d=g.value[t];d&&d.isParent===!0&&L(t,!0)})},fail:()=>{delete b.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else i.isParent===!0&&i.expandable===!0&&L(t,a)}function L(t,a){let e=q.value;const i=l.expanded!==void 0;if(i===!0&&(e=e.slice()),a){if(l.accordion&&g.value[t]){const r=[];g.value[t].parent?g.value[t].parent.children.forEach(d=>{d.key!==t&&d.expandable===!0&&r.push(d.key)}):l.nodes.forEach(d=>{const s=d[l.nodeKey];s!==t&&r.push(s)}),r.length!==0&&(e=e.filter(d=>r.includes(d)===!1))}e=e.concat([t]).filter((r,d,s)=>s.indexOf(r)===d)}else e=e.filter(r=>r!==t);i===!0?n("update:expanded",e):q.value=e}function J(t){return t&&g.value[t]?g.value[t].ticked:!1}function E(t,a){let e=C.value;const i=l.ticked!==void 0;i===!0&&(e=e.slice()),a?e=e.concat(t).filter((r,d,s)=>s.indexOf(r)===d):e=e.filter(r=>t.includes(r)===!1),i===!0&&n("update:ticked",e)}function c(t,a,e){const i={tree:m,node:t,key:e,color:l.color,dark:_.value};return ae(i,"expanded",()=>a.expanded,r=>{r!==a.expanded&&B(e,r)}),ae(i,"ticked",()=>a.ticked,r=>{r!==a.ticked&&E([e],r)}),i}function S(t){return(l.filter?t.filter(a=>g.value[a[l.nodeKey]].matchesFilter):t).map(a=>se(a))}function j(t){if(t.icon!==void 0)return o(Z,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const a=t.img||t.avatar;if(a)return o("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:a})}function oe(){n("afterShow")}function de(){n("afterHide")}function se(t){const a=t[l.nodeKey],e=g.value[a],i=t.header&&y[`header-${t.header}`]||y["default-header"],r=e.isParent===!0?S(t[l.childrenKey]):[],d=r.length!==0||e.lazy&&e.lazy!=="loaded";let s=t.body&&y[`body-${t.body}`]||y["default-body"];const I=i!==void 0||s!==void 0?c(t,e,a):null;return s!==void 0&&(s=o("div",{class:"q-tree__node-body relative-position"},[o("div",{class:k.value},[s(I)])])),o("div",{key:a,class:`q-tree__node relative-position q-tree__node--${d===!0?"parent":"child"}`},[o("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,onClick:h=>{ee(t,e,h)},onKeypress(h){me(h)!==!0&&(h.keyCode===13?ee(t,e,h,!0):h.keyCode===32&&W(t,e,h,!0))}},[o("div",{class:"q-focus-helper",tabindex:-1,ref:h=>{K[e.key]=h}}),e.lazy==="loading"?o(qe,{class:"q-tree__spinner",color:w.value}):d===!0?o(Z,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:T.value,onClick(h){W(t,e,h)}}):null,e.hasTicking===!0&&e.noTick!==!0?o(Fe,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:w.value,dark:_.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:Q,"onUpdate:modelValue":h=>{fe(e,h)}}):null,o("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?V.value:k.value)},[i?i(I):[j(t),o("div",t[l.labelKey])]])]),d===!0?l.noTransition===!0?o("div",{class:"q-tree__node-collapsible"+k.value,key:`${a}__q`},[s,o("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},e.expanded?r:null)]):o(we,{duration:l.duration,onShow:oe,onHide:de},()=>Se(o("div",{class:"q-tree__node-collapsible"+k.value,key:`${a}__q`},[s,o("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},r)]),[[Ce,e.expanded]])):s])}function p(t){const a=K[t];a&&a.focus()}function ee(t,a,e,i){i!==!0&&a.selectable!==!1&&p(a.key),O.value&&a.selectable?l.noSelectionUnset===!1?n("update:selected",a.key!==l.selected?a.key:null):a.key!==l.selected&&n("update:selected",a.key===void 0?null:a.key):W(t,a,e,i),typeof t.handler=="function"&&t.handler(t)}function W(t,a,e,i){e!==void 0&&Q(e),i!==!0&&a.selectable!==!1&&p(a.key),B(a.key,!a.expanded,t,a)}function fe(t,a){if(t.indeterminate===!0&&(a=t.indeterminateNextState),t.strictTicking)E([t.key],a);else if(t.leafTicking){const e=[],i=r=>{r.isParent?(a!==!0&&r.noTick!==!0&&r.tickable===!0&&e.push(r.key),r.leafTicking===!0&&r.children.forEach(i)):r.noTick!==!0&&r.tickable===!0&&(r.leafFilteredTicking!==!0||r.matchesFilter===!0)&&e.push(r.key)};i(t),E(e,a)}}return l.defaultExpandAll===!0&&A(),Object.assign(m,{getNodeByKey:$,getTickedNodes:D,getExpandedNodes:H,isExpanded:U,collapseAll:G,expandAll:A,setExpanded:B,isTicked:J,setTicked:E}),()=>{const t=S(l.nodes);return o("div",{class:R.value},t.length===0?l.filter?l.noResultsLabel||x.lang.tree.noResults:l.noNodesLabel||x.lang.tree.noNodes:t)}}});export{je as Q,Fe as a,Ee as b,Ie as c,Ae as u};
