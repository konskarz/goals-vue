import{b as M,a as Q,Q as V}from"./api.client-8cb6dbfd.js";import{Q as v,_ as x}from"./WeekTimelineEntry-6b1f0e15.js";import{Q as F}from"./QPage-7b404d76.js";import{d as e}from"./date-406de864.js";import{_ as I}from"./GoalSelect-684185e9.js";import{r as C,f as E,o as B,w as G,a0 as i,a1 as m,a5 as r,a6 as f,a8 as L,ax as c,a9 as g,aa as N,ab as y,ay as w}from"./index-b46a5b62.js";import"./QList-3bb0ab93.js";import"./format-63080275.js";import"./QItemLabel-3f004799.js";import"./NumberInput-f6534bb0.js";import"./DurationInput-f82a5114.js";import"./QMenu-65a0bdf7.js";const J={__name:"CalendarView",setup(O){const u="Goal-Filter",k=e.formatDate(new Date,"YYYY-w"),l=C(null),{data:D,mutate:T}=M.read("/tasks/"),_=E(()=>{const a=D.value.length,o=a?[...D.value].sort((d,h)=>Date.parse(d.planned)-Date.parse(h.planned)):null,t=a?new Date(o[0].planned):new Date,n=a?new Date(o[o.length-1].planned):e.addToDate(t,{days:7}),Y=e.addToDate(n,{days:7});let s=e.subtractFromDate(t,{days:e.getDayOfWeek(t)-1});const b=e.subtractFromDate(Y,{days:e.getDayOfWeek(Y)-1});let p={};for(;s<=b;)p[e.formatDate(s,"YYYY-w")]={day:e.formatDate(s,"YYYY-MM-DD"),tasks:[]},s=e.addToDate(s,{days:7});return a&&o.forEach(d=>{p[e.formatDate(d.planned,"YYYY-w")].tasks.push(d)}),p});return B(()=>{const a=localStorage.getItem(u);a&&(l.value=parseInt(a))}),G(l,a=>{a?localStorage.setItem(u,a):localStorage.removeItem(u)}),(a,o)=>(r(),i(F,{padding:""},{default:m(()=>[f(V,null,{default:m(()=>[f(Q,null,{default:m(()=>[L("Tasks")]),_:1}),f(I,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),label:"For Goal",dense:"",borderless:"",class:"col-6 col-sm-3 col-lg-2"},null,8,["modelValue"])]),_:1}),c(_)?(r(),i(v,{key:0,layout:"dense",class:"q-px-md"},{default:m(()=>[(r(!0),g(y,null,N(c(_),(t,n)=>(r(),g(y,{key:n},[t.day?(r(),i(x,{key:0,color:n===c(k)?"orange":"",week:t,onMutate:c(T)},null,8,["color","week","onMutate"])):w("",!0)],64))),128))]),_:1})):w("",!0)]),_:1}))}};export{J as default};
