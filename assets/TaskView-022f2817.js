import{Q as P,a as $}from"./QToolbar-a8fd52ba.js";import{d as T,a6 as r,a7 as s,a8 as V,a9 as u,ak as f,ac as e,av as w,aw as g,r as I,w as M,am as S,aa as Y,ar as H,ah as c,ax as Q,ay as K,aq as R}from"./index-c653666b.js";import{Q as F}from"./QForm-64319ae7.js";import{Q as G,_ as j}from"./GoalSelect-98b16388.js";import{u as z,d as A}from"./TaskStore-113a0c8b.js";import{u as E,_ as x}from"./DateInput-ab40edee.js";import"./QSlideTransition-12a41255.js";const _={__name:"NumberInput",props:{label:{type:String,required:!0},modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(k,{emit:y}){const v=k,t=T({get(){return v.modelValue},set(l){l>=0&&y("update:modelValue",l)}});return(l,d)=>(r(),s(g,{modelValue:e(t),"onUpdate:modelValue":d[2]||(d[2]=i=>w(t)?t.value=i:null),modelModifiers:{number:!0},type:"number",min:"0",label:k.label,"stack-label":""},{append:V(()=>[u(f,{round:"",label:"-1",onClick:d[0]||(d[0]=i=>t.value--)}),u(f,{round:"",label:"+1",onClick:d[1]||(d[1]=i=>t.value++)})]),_:1},8,["modelValue","label"]))}},J={class:"q-px-lg q-py-sm"},L={class:"row q-col-gutter-lg"},ae={__name:"TaskView",setup(k){const y=S(),v=z(),t=parseInt(y.params.id),{item:l,original:d,path:i,persist:U,changed:C,remove:N,save:B,back:q}=E(t,v,{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),p=I(!1),D=T(()=>!l.value.name||U.value||!!(t&&!C(d,{...l.value}))),b=T(()=>{const n=l.value.performance_history;if(!n||!n.length)return null;const o=m=>A.formatDate(m.updated,"DD.MM.YYYY HH:mm")+" to "+m.value;let a=o(n[0]);if(n.length===1)return a;for(let m=1;m<n.length;m++)a+=", "+o(n[m]);return a});return M(p,n=>{i.value=n?"recurring/"+l.value.group_id+"/":t+"/"}),(n,o)=>(r(),s(G,null,{default:V(()=>[u(F,{onSubmit:R(e(B),["prevent"])},{default:V(()=>[u(P,{class:"q-mt-md q-pl-lg"},{default:V(()=>[u($,null,{default:V(()=>[Y("Task")]),_:1}),e(l).group_id?(r(),s(H,{key:0,modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=a=>p.value=a),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):c("",!0),e(t)?(r(),s(f,{key:1,type:"button",flat:"",round:"",icon:"delete",disable:e(U),onClick:e(N)},null,8,["disable","onClick"])):c("",!0),u(f,{type:"submit",flat:"",round:"",icon:"save",disable:e(D)},null,8,["disable"]),u(f,{type:"button",flat:"",round:"",icon:"clear",onClick:e(q)},null,8,["onClick"])]),_:1}),Q("div",J,[Q("div",L,[u(g,{modelValue:e(l).name,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(t),rules:[a=>!!a||"Field is required"],class:"col-12 col-lg-6",onKeyup:K(e(q),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),u(j,{modelValue:e(l).goal,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-lg-6"},null,8,["modelValue"]),p.value?c("",!0):(r(),s(x,{key:0,modelValue:e(l).planned,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).planned=a),label:"Planned",class:"col-12 col-lg-6"},null,8,["modelValue"])),e(t)?(r(),s(x,{key:1,modelValue:e(l).done,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).done=a),label:"Done",class:"col-12 col-lg-6"},null,8,["modelValue"])):(r(),s(x,{key:2,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-lg-6"},null,8,["modelValue"])),u(_,{modelValue:e(l).target,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).target=a),label:"Target",class:"col-12 col-lg-6"},null,8,["modelValue"]),p.value?c("",!0):(r(),s(_,{key:3,modelValue:e(l).performance,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-lg-6"},null,8,["modelValue"]))]),u(g,{modelValue:e(l).description,"onUpdate:modelValue":o[8]||(o[8]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(b)?(r(),s(g,{key:0,modelValue:e(b),"onUpdate:modelValue":o[9]||(o[9]=a=>w(b)?b.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):c("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{ae as default};
