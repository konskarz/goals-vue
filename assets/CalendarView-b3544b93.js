import{b as N,a as B,Q as C}from"./api.client-e84551a0.js";import{Q as V}from"./QItemLabel-83b3ee4f.js";import{Q as k,a as i}from"./format-01a0d5de.js";import{r as E,f as w,o as L,w as M,a0 as g,a1 as o,a5 as d,a6 as t,a8 as _,a7 as O,b5 as y,ax as m,a9 as b,aa as U,ab as Y,ay as S}from"./index-1c6f01de.js";import{Q as W}from"./QList-10f5bc9a.js";import{Q as h}from"./QMenu-c2b320f8.js";import{Q as H,_ as J}from"./WeekTimelineEntry-76c026a4.js";import{Q as K}from"./QPage-6aff0a7a.js";import{d as n}from"./date-480e060b.js";import{_ as $}from"./GoalSelect-977f88cd.js";import"./NumberInput-7d48ef16.js";import"./DurationInput-6a7f284f.js";const oe={__name:"CalendarView",setup(q){const v="Tasks-Filter",f=e=>n.subtractFromDate(e,{days:n.getDayOfWeek(e)-1}),c=e=>n.formatDate(e,"YYYY-w"),Q=n.startOfDate(new Date,"day"),p=f(Q),x=c(Q),r=E({done:!0,recurring:!0,goal:null}),{data:I,mutate:F}=N.read("/tasks/"),u=w(()=>I.value.filter(e=>{const a=new Date(e.planned.slice(0,10))<p;return a&&r.value.done&&e.done||a&&r.value.recurring&&e.group_id?!1:!(r.value.goal&&r.value.goal!==e.goal)}).sort((e,a)=>Date.parse(e.planned)-Date.parse(a.planned))),D=w(()=>{const e=(a,l,s)=>{for(;l<=s;)a[c(l)]={day:n.formatDate(l,"YYYY-MM-DD"),tasks:[]},l=n.addToDate(l,{days:7});return a};if(u.value.length){const a=new Date(u.value[0].planned.slice(0,10)),l=n.addToDate(new Date(u.value[u.value.length-1].planned.slice(0,10)),{days:7}),s=e({},f(a),f(l));return u.value.forEach(T=>{s[c(T.planned)].tasks.push(T)}),s}return e({},p,n.addToDate(p,{days:14}))});return L(()=>{const e=localStorage.getItem(v);e&&(r.value=JSON.parse(e))}),M(()=>r.value,e=>{localStorage.setItem(v,JSON.stringify(e))},{deep:!0}),(e,a)=>(d(),g(K,{padding:""},{default:o(()=>[t(C,null,{default:o(()=>[t(B,null,{default:o(()=>[_("Tasks")]),_:1}),t($,{modelValue:r.value.goal,"onUpdate:modelValue":a[0]||(a[0]=l=>r.value.goal=l),label:"For Goal",dense:"",borderless:"",class:"col-6 col-sm-3 col-lg-2"},null,8,["modelValue"]),t(O,{flat:"",round:"",icon:"filter_list"},{default:o(()=>[t(h,null,{default:o(()=>[t(W,null,{default:o(()=>[t(k,null,{default:o(()=>[t(i,null,{default:o(()=>[t(V,null,{default:o(()=>[_("Hide passed done")]),_:1})]),_:1}),t(i,{side:""},{default:o(()=>[t(y,{modelValue:r.value.done,"onUpdate:modelValue":a[1]||(a[1]=l=>r.value.done=l)},null,8,["modelValue"])]),_:1})]),_:1}),t(k,null,{default:o(()=>[t(i,null,{default:o(()=>[t(V,null,{default:o(()=>[_("Hide passed recurring")]),_:1})]),_:1}),t(i,{side:""},{default:o(()=>[t(y,{modelValue:r.value.recurring,"onUpdate:modelValue":a[2]||(a[2]=l=>r.value.recurring=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),m(D)?(d(),g(H,{key:0,layout:"dense",class:"q-px-md"},{default:o(()=>[(d(!0),b(Y,null,U(m(D),(l,s)=>(d(),b(Y,{key:s},[l.day?(d(),g(J,{key:0,color:s===m(x)?"orange":"",week:l,onMutate:m(F)},null,8,["color","week","onMutate"])):S("",!0)],64))),128))]),_:1})):S("",!0)]),_:1}))}};export{oe as default};
