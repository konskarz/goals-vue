import{d as T,a2 as r,a3 as m,ac as O,a4 as u,a5 as s,aj as e,aA as Y,ap as p,a7 as $,a6 as c,ao as U,aB as f,aC as A,aD as H,aq as I}from"./index-ce6383c7.js";import{Q as K,a as M}from"./QToolbar-896af552.js";import{Q as R}from"./QForm-9790a288.js";import{Q as F}from"./GoalStore-e88f658c.js";import{_ as x,u as G}from"./NumberInput-c8056529.js";import{d as j}from"./date-ab8c3bb6.js";import{u as h}from"./TaskStore-69ac1c43.js";import{u as z,_ as V}from"./DateInput-47769e8a.js";import{_ as E}from"./GoalSelect-f1211f85.js";import"./format-8c778330.js";import"./QSlideTransition-74a136f3.js";import"./QMenu-3d3960b2.js";const J={class:"q-pa-md"},L={class:"row q-col-gutter-lg"},de={__name:"TaskView",setup(W){const D=O(),g=G(),q=h(),i=parseInt(D.params.id),{item:l,original:B,path:C,persist:b,changed:P,remove:k,save:v,back:y}=z(i,q,{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),w=T(()=>!l.value.name||b.value||!!(i&&!P(B,{...l.value}))),d=T(()=>{const t=l.value.performance_history;if(!t||!t.length)return null;const o=n=>j.formatDate(n.updated,"DD.MM.YYYY HH:mm")+" to "+n.value;let a=o(t[0]);if(t.length===1)return a;for(let n=1;n<t.length;n++)a+=", "+o(t[n]);return a}),_={type:"radio",model:"this",items:[{label:"This task",value:"this"},{label:"All tasks",value:"all"}]};function Q(){C.value="recurring/"+l.value.group_id+"/"}function N(){l.value.group_id?g.dialog({title:"Delete recurring task",cancel:!0,ok:"Delete",options:_}).onOk(t=>{t==="all"&&Q(),k()}):k()}function S(){l.value.group_id?g.dialog({title:"Save recurring task",cancel:!0,ok:"Save",options:_}).onOk(t=>{t==="all"&&Q(),v()}):v()}return(t,o)=>(u(),r(F,{padding:""},{default:m(()=>[s(R,{onSubmit:I(S,["prevent"])},{default:m(()=>[s(K,null,{default:m(()=>[e(l).group_id?(u(),r(Y,{key:0,icon:"event_repeat"})):p("",!0),s(M,null,{default:m(()=>[$("Task")]),_:1}),e(i)?(u(),r(c,{key:1,type:"button",flat:"",round:"",icon:"delete",disable:e(b),onClick:N},null,8,["disable"])):p("",!0),s(c,{type:"submit",flat:"",round:"",icon:"save",disable:e(w)},null,8,["disable"]),s(c,{type:"button",flat:"",round:"",icon:"clear",onClick:e(y)},null,8,["onClick"])]),_:1}),U("div",J,[U("div",L,[s(f,{modelValue:e(l).name,"onUpdate:modelValue":o[0]||(o[0]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(i),rules:[a=>!!a||"Field is required"],class:"col-12 col-sm-6",onKeyup:A(e(y),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),s(E,{modelValue:e(l).goal,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-sm-6"},null,8,["modelValue"]),s(V,{modelValue:e(l).planned,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).planned=a),label:"Planned",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(i)?(u(),r(V,{key:0,modelValue:e(l).done,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).done=a),label:"Done",class:"col-12 col-sm-6"},null,8,["modelValue"])):(u(),r(V,{key:1,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-sm-6"},null,8,["modelValue"])),s(x,{modelValue:e(l).target,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).target=a),label:"Target",class:"col-12 col-sm-6"},null,8,["modelValue"]),s(x,{modelValue:e(l).performance,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-sm-6"},null,8,["modelValue"])]),s(f,{modelValue:e(l).description,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(d)?(u(),r(f,{key:0,modelValue:e(d),"onUpdate:modelValue":o[8]||(o[8]=a=>H(d)?d.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):p("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{de as default};
