import{b as x}from"./use-dark-74eb2e5e.js";import{Q as M}from"./QToggle-4ae88de7.js";import{j as y,Q as u,R as t,S as p,T as n,U as b,r as N,w as $,V as Q,Z as l,$ as f,af as I,a6 as P}from"./index-237da410.js";import{Q as k,a as _}from"./QForm-7b04b2d0.js";import{u as B,M as Y,d as F}from"./MainPage-b6f0d248.js";import{u as H,_ as g}from"./DateInput-3db9e9ef.js";import{_ as K}from"./GoalSelect-05d0f3ca.js";import"./use-field-5a115d5a.js";import"./uid-6a237b22.js";import"./format-8c778330.js";import"./QSlideTransition-fde5fe8e.js";import"./use-timeout-684486c7.js";import"./use-model-toggle-504d87a8.js";const q={__name:"NumberInput",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(v,{emit:U}){const r=v,e=y({get(){return r.modelValue},set(V){V>=0&&U("update:modelValue",V)}});return(V,d)=>(u(),t(k,{modelValue:e.value,"onUpdate:modelValue":d[2]||(d[2]=s=>e.value=s),modelModifiers:{number:!0},type:"number",min:"0","stack-label":""},{append:p(()=>[n(b,{round:"",label:"-1",onClick:d[0]||(d[0]=s=>e.value--)}),n(b,{round:"",label:"+1",onClick:d[1]||(d[1]=s=>e.value++)})]),_:1},8,["modelValue"]))}},ee={__name:"TaskView",props:{id:{type:String,required:!0}},setup(v){const r=parseInt(v.id),{item:e,original:V,path:d,persist:s,changed:w,remove:S,save:C,back:T}=H(r,B(),{name:"",goal:null,planned:new Date().toISOString(),recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),m=N(!1),D=y(()=>!e.value.name||!e.value.planned||s.value||!!(r&&!w(V,{...e.value}))),c=y(()=>{const i=e.value.performance_history;return!i||!i.length?null:i.map(a=>F.formatDate(a.updated,"DD.MM.YYYY HH:mm")+" to "+a.value).join(", ")});return $(m,i=>{d.value=i?"recurring/"+e.value.group_id+"/":r+"/"}),(i,a)=>(u(),t(Y,null,{toolbar:p(()=>[m.value?(u(),t(x,{key:1},{default:p(()=>[Q("Group")]),_:1})):(u(),t(x,{key:0},{default:p(()=>[Q("Task")]),_:1})),l(e).group_id?(u(),t(M,{key:2,modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=o=>m.value=o),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):f("",!0),l(r)?(u(),t(b,{key:3,flat:"",round:"",icon:"delete",disable:l(s),onClick:l(S)},null,8,["disable","onClick"])):f("",!0),n(b,{flat:"",round:"",icon:"save",disable:D.value,onClick:l(C)},null,8,["disable","onClick"]),n(b,{flat:"",round:"",icon:"clear",onClick:l(T)},null,8,["onClick"])]),default:p(()=>[n(_,{class:"q-pt-sm q-px-lg",onSubmit:P(l(C),["prevent"])},{default:p(()=>[n(k,{modelValue:l(e).name,"onUpdate:modelValue":a[1]||(a[1]=o=>l(e).name=o),label:"Name","stack-label":"",autofocus:!l(r),rules:[o=>!!o||"Field is required"],onKeyup:I(l(T),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),n(K,{modelValue:l(e).goal,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).goal=o),label:"Goal","stack-label":""},null,8,["modelValue"]),m.value?f("",!0):(u(),t(g,{key:0,modelValue:l(e).planned,"onUpdate:modelValue":a[3]||(a[3]=o=>l(e).planned=o),label:"Planned",rules:[o=>!!o||"Field is required"]},null,8,["modelValue","rules"])),l(r)?(u(),t(g,{key:1,modelValue:l(e).done,"onUpdate:modelValue":a[4]||(a[4]=o=>l(e).done=o),label:"Done"},null,8,["modelValue"])):(u(),t(g,{key:2,modelValue:l(e).recurring_until,"onUpdate:modelValue":a[5]||(a[5]=o=>l(e).recurring_until=o),label:"Recurring until"},null,8,["modelValue"])),n(q,{modelValue:l(e).target,"onUpdate:modelValue":a[6]||(a[6]=o=>l(e).target=o),label:"Target"},null,8,["modelValue"]),m.value?f("",!0):(u(),t(q,{key:3,modelValue:l(e).performance,"onUpdate:modelValue":a[7]||(a[7]=o=>l(e).performance=o),label:"Performance"},null,8,["modelValue"])),n(k,{modelValue:l(e).description,"onUpdate:modelValue":a[8]||(a[8]=o=>l(e).description=o),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),c.value&&!m.value?(u(),t(k,{key:4,modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=o=>c.value=o),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):f("",!0)]),_:1},8,["onSubmit"])]),_:1}))}};export{ee as default};
