import{f as w,a0 as u,a1 as p,a3 as C,a5 as r,a6 as t,ax as e,b6 as N,ay as d,a8 as $,a7 as c,aG as x,b0 as f,b7 as B,a_ as H,aH as O}from"./index-31918b08.js";import{Q as S,a as Y}from"./api.client-b4068342.js";import{Q as I}from"./QForm-db5d0767.js";import{Q as K}from"./QPage-ca4c7a03.js";import{u as M,_ as T}from"./NumberInput-b8a7a2ff.js";import{d as R}from"./date-d054f4f6.js";import{u as A,_ as V}from"./DateInput-f0a545f8.js";import{_ as F}from"./GoalSelect-0ba5a264.js";import{_ as G}from"./DurationInput-54a23bc8.js";import"./format-58a3ee3f.js";import"./QItemLabel-55c19976.js";import"./QMenu-6f819c7b.js";const j={class:"q-pa-md"},z={class:"row q-col-gutter-lg"},se={__name:"TaskView",setup(E){const D=C(),b=M(),i=parseInt(D.params.id),g="recurring/",{item:l,path:k,persist:_,remove:v,save:y,back:Q}=A({name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,planned_total_time:null,done:null,description:"",performance_history:[]},"/tasks/",i),m=w(()=>{const n=l.value.performance_history;if(!n||!n.length)return null;const o=s=>R.formatDate(s.updated,"DD.MM.YYYY HH:mm")+" to "+s.value;let a=o(n[0]);if(n.length===1)return a;for(let s=1;s<n.length;s++)a+=", "+o(n[s]);return a}),U={type:"radio",model:"this",items:[{label:"This task",value:"this"},{label:"All tasks",value:"all"}]};function q(){l.value.group_id?b.dialog({title:"Delete recurring task",cancel:!0,ok:"Delete",options:U}).onOk(n=>{n==="all"&&(k.value=g+l.value.group_id+"/"),v()}):v()}function P(){l.value.group_id?b.dialog({title:"Save recurring task",cancel:!0,ok:"Save",options:U}).onOk(n=>{n==="all"&&(k.value=g+l.value.group_id+"/"),y()}):y()}return(n,o)=>(r(),u(K,{padding:""},{default:p(()=>[t(I,{onSubmit:O(P,["prevent"])},{default:p(()=>[t(S,null,{default:p(()=>[e(l).group_id?(r(),u(N,{key:0,icon:"event_repeat"})):d("",!0),t(Y,null,{default:p(()=>[$("Task")]),_:1}),e(i)?(r(),u(c,{key:1,type:"button",flat:"",round:"",icon:"delete",disable:e(_),onClick:q},null,8,["disable"])):d("",!0),t(c,{type:"submit",flat:"",round:"",icon:"save",disable:!e(l).name||e(_)},null,8,["disable"]),t(c,{type:"button",flat:"",round:"",icon:"clear",onClick:e(Q)},null,8,["onClick"])]),_:1}),x("div",j,[t(f,{modelValue:e(l).name,"onUpdate:modelValue":o[0]||(o[0]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(i),rules:[a=>!!a||"Field is required"],onKeyup:B(e(Q),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),x("div",z,[t(F,{modelValue:e(l).goal,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(V,{modelValue:e(l).planned,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).planned=a),label:"Planned",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(i)?d("",!0):(r(),u(V,{key:0,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-sm-6"},null,8,["modelValue"])),t(T,{modelValue:e(l).target,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).target=a),label:"Target",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(T,{modelValue:e(l).performance,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(G,{modelValue:e(l).planned_total_time,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).planned_total_time=a),label:"Planned total time",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(i)?(r(),u(V,{key:1,modelValue:e(l).done,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).done=a),label:"Done",class:"col-12 col-sm-6"},null,8,["modelValue"])):d("",!0)]),t(f,{modelValue:e(l).description,"onUpdate:modelValue":o[8]||(o[8]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(m)?(r(),u(f,{key:0,modelValue:e(m),"onUpdate:modelValue":o[9]||(o[9]=a=>H(m)?m.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):d("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{se as default};
