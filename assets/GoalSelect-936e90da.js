import{c as L,D as ae,g as G,E as ie,r as A,aJ as xe,d as x,w as U,h as d,b as _e,aK as me,aL as qe,ae as p,aM as Se,C as le,J as Ce,aw as we,aN as H,S as R,ak as Te,aO as Ke,aP as Ae,aQ as Ee,aR as Pe,a4 as Fe,a2 as Ne,a3 as F,ao as Qe,af as Be,aj as V,a5 as z,aD as ne}from"./index-c0954342.js";import{Q as $e}from"./QSlideTransition-7ccc46b4.js";import{u as Ve,a as ze,Q as Le}from"./QMenu-326e6cb6.js";import{u as Me}from"./GoalStore-aaf71ef6.js";const De=["none","strict","leaf","leaf-filtered"],Ie=L({name:"QTree",props:{...ae,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>De.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:b,emit:s}){const{proxy:g}=G(),{$q:_}=g,q=ie(l,_),y=A({}),u=A(l.ticked||[]),k=A(l.expanded||[]);let S={};xe(()=>{S={}});const E=x(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(q.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),C=x(()=>l.selected!==void 0),M=x(()=>l.icon||_.iconSet.tree.icon),N=x(()=>l.controlColor||l.color),w=x(()=>l.textColor!==void 0?` text-${l.textColor}`:""),h=x(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),P=x(()=>l.filterMethod!==void 0?l.filterMethod:(t,n)=>{const e=n.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)>-1}),m=x(()=>{const t={},n=(e,i)=>{const a=e.tickStrategy||(i?i.tickStrategy:l.tickStrategy),c=e[l.nodeKey],o=e[l.childrenKey]&&e[l.childrenKey].length!==0,T=e.disabled!==!0&&C.value===!0&&e.selectable!==!1,v=e.disabled!==!0&&e.expandable!==!1,be=a!=="none",$=a==="strict",ee=a==="leaf-filtered",O=a==="leaf"||a==="leaf-filtered";let j=e.disabled!==!0&&e.tickable!==!1;O===!0&&j===!0&&i&&i.tickable!==!0&&(j=!1);let K=e.lazy;K===!0&&y.value[c]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(K=y.value[c]);const r={key:c,parent:i,isParent:o,lazy:K,disabled:e.disabled,link:e.disabled!==!0&&(T===!0||v===!0&&(o===!0||K===!0)),children:[],matchesFilter:l.filter?P.value(e,l.filter):!0,selected:c===l.selected&&T===!0,selectable:T,expanded:o===!0?k.value.includes(c):!1,expandable:v,noTick:e.noTick===!0||$!==!0&&K&&K!=="loaded",tickable:j,tickStrategy:a,hasTicking:be,strictTicking:$,leafFilteredTicking:ee,leafTicking:O,ticked:$===!0?u.value.includes(c):o===!0?!1:u.value.includes(c)};if(t[c]=r,o===!0&&(r.children=e[l.childrenKey].map(f=>n(f,r)),l.filter&&(r.matchesFilter!==!0?r.matchesFilter=r.children.some(f=>f.matchesFilter):r.noTick!==!0&&r.disabled!==!0&&r.tickable===!0&&ee===!0&&r.children.every(f=>f.matchesFilter!==!0||f.noTick===!0||f.tickable!==!0)===!0&&(r.tickable=!1)),r.matchesFilter===!0&&(r.noTick!==!0&&$!==!0&&r.children.every(f=>f.noTick)===!0&&(r.noTick=!0),O))){if(r.ticked=!1,r.indeterminate=r.children.some(f=>f.indeterminate===!0),r.tickable=r.tickable===!0&&r.children.some(f=>f.tickable),r.indeterminate!==!0){const f=r.children.reduce((te,ge)=>ge.ticked===!0?te+1:te,0);f===r.children.length?r.ticked=!0:f>0&&(r.indeterminate=!0)}r.indeterminate===!0&&(r.indeterminateNextState=r.children.every(f=>f.tickable!==!0||f.ticked!==!0))}return r};return l.nodes.forEach(e=>n(e,null)),t});U(()=>l.ticked,t=>{u.value=t}),U(()=>l.expanded,t=>{k.value=t});function Q(t){const n=[].reduce,e=(i,a)=>{if(i||!a)return i;if(Array.isArray(a)===!0)return n.call(Object(a),e,i);if(a[l.nodeKey]===t)return a;if(a[l.childrenKey])return e(null,a[l.childrenKey])};return e(null,l.nodes)}function re(){return u.value.map(t=>Q(t))}function ce(){return k.value.map(t=>Q(t))}function de(t){return t&&m.value[t]?m.value[t].expanded:!1}function ue(){l.expanded!==void 0?s("update:expanded",[]):k.value=[]}function J(){const t=[],n=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(n))};l.nodes.forEach(n),l.expanded!==void 0?s("update:expanded",t):k.value=t}function D(t,n,e=Q(t),i=m.value[t]){if(i.lazy&&i.lazy!=="loaded"){if(i.lazy==="loading")return;y.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),s("lazyLoad",{node:e,key:t,done:a=>{y.value[t]="loaded",e[l.childrenKey]=Array.isArray(a)===!0?a:[],_e(()=>{const c=m.value[t];c&&c.isParent===!0&&W(t,!0)})},fail:()=>{delete y.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else i.isParent===!0&&i.expandable===!0&&W(t,n)}function W(t,n){let e=k.value;const i=l.expanded!==void 0;if(i===!0&&(e=e.slice()),n){if(l.accordion&&m.value[t]){const a=[];m.value[t].parent?m.value[t].parent.children.forEach(c=>{c.key!==t&&c.expandable===!0&&a.push(c.key)}):l.nodes.forEach(c=>{const o=c[l.nodeKey];o!==t&&a.push(o)}),a.length!==0&&(e=e.filter(c=>a.includes(c)===!1))}e=e.concat([t]).filter((a,c,o)=>o.indexOf(a)===c)}else e=e.filter(a=>a!==t);i===!0?s("update:expanded",e):k.value=e}function oe(t){return t&&m.value[t]?m.value[t].ticked:!1}function B(t,n){let e=u.value;const i=l.ticked!==void 0;i===!0&&(e=e.slice()),n?e=e.concat(t).filter((a,c,o)=>o.indexOf(a)===c):e=e.filter(a=>t.includes(a)===!1),i===!0&&s("update:ticked",e)}function se(t,n,e){const i={tree:g,node:t,key:e,color:l.color,dark:q.value};return H(i,"expanded",()=>n.expanded,a=>{a!==n.expanded&&D(e,a)}),H(i,"ticked",()=>n.ticked,a=>{a!==n.ticked&&B([e],a)}),i}function X(t){return(l.filter?t.filter(n=>m.value[n[l.nodeKey]].matchesFilter):t).map(n=>ye(n))}function fe(t){if(t.icon!==void 0)return d(p,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const n=t.img||t.avatar;if(n)return d("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:n})}function he(){s("afterShow")}function ve(){s("afterHide")}function ye(t){const n=t[l.nodeKey],e=m.value[n],i=t.header&&b[`header-${t.header}`]||b["default-header"],a=e.isParent===!0?X(t[l.childrenKey]):[],c=a.length!==0||e.lazy&&e.lazy!=="loaded";let o=t.body&&b[`body-${t.body}`]||b["default-body"];const T=i!==void 0||o!==void 0?se(t,e,n):null;return o!==void 0&&(o=d("div",{class:"q-tree__node-body relative-position"},[d("div",{class:w.value},[o(T)])])),d("div",{key:n,class:`q-tree__node relative-position q-tree__node--${c===!0?"parent":"child"}`},[d("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,onClick:v=>{Z(t,e,v)},onKeypress(v){me(v)!==!0&&(v.keyCode===13?Z(t,e,v,!0):v.keyCode===32&&I(t,e,v,!0))}},[d("div",{class:"q-focus-helper",tabindex:-1,ref:v=>{S[e.key]=v}}),e.lazy==="loading"?d(qe,{class:"q-tree__spinner",color:N.value}):c===!0?d(p,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:M.value,onClick(v){I(t,e,v)}}):null,e.hasTicking===!0&&e.noTick!==!0?d(Se,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:N.value,dark:q.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:le,"onUpdate:modelValue":v=>{ke(e,v)}}):null,d("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?h.value:w.value)},[i?i(T):[fe(t),d("div",t[l.labelKey])]])]),c===!0?l.noTransition===!0?d("div",{class:"q-tree__node-collapsible"+w.value,key:`${n}__q`},[o,d("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},e.expanded?a:null)]):d($e,{duration:l.duration,onShow:he,onHide:ve},()=>Ce(d("div",{class:"q-tree__node-collapsible"+w.value,key:`${n}__q`},[o,d("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},a)]),[[we,e.expanded]])):o])}function Y(t){const n=S[t];n&&n.focus()}function Z(t,n,e,i){i!==!0&&n.selectable!==!1&&Y(n.key),C.value&&n.selectable?l.noSelectionUnset===!1?s("update:selected",n.key!==l.selected?n.key:null):n.key!==l.selected&&s("update:selected",n.key===void 0?null:n.key):I(t,n,e,i),typeof t.handler=="function"&&t.handler(t)}function I(t,n,e,i){e!==void 0&&le(e),i!==!0&&n.selectable!==!1&&Y(n.key),D(n.key,!n.expanded,t,n)}function ke(t,n){if(t.indeterminate===!0&&(n=t.indeterminateNextState),t.strictTicking)B([t.key],n);else if(t.leafTicking){const e=[],i=a=>{a.isParent?(n!==!0&&a.noTick!==!0&&a.tickable===!0&&e.push(a.key),a.leafTicking===!0&&a.children.forEach(i)):a.noTick!==!0&&a.tickable===!0&&(a.leafFilteredTicking!==!0||a.matchesFilter===!0)&&e.push(a.key)};i(t),B(e,n)}}return l.defaultExpandAll===!0&&J(),Object.assign(g,{getNodeByKey:Q,getTickedNodes:re,getExpandedNodes:ce,isExpanded:de,collapseAll:ue,expandAll:J,setExpanded:D,isTicked:oe,setTicked:B}),()=>{const t=X(l.nodes);return d("div",{class:E.value},t.length===0?l.filter?l.noResultsLabel||_.lang.tree.noResults:l.noNodesLabel||_.lang.tree.noNodes:t)}}}),Oe=L({name:"QBanner",props:{...ae,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(l,{slots:b}){const{proxy:{$q:s}}=G(),g=ie(l,s),_=x(()=>"q-banner row items-center"+(l.dense===!0?" q-banner--dense":"")+(g.value===!0?" q-banner--dark q-dark":"")+(l.rounded===!0?" rounded-borders":"")),q=x(()=>`q-banner__actions row items-center justify-end col-${l.inlineActions===!0?"auto":"all"}`);return()=>{const y=[d("div",{class:"q-banner__avatar col-auto row items-center self-start"},R(b.avatar)),d("div",{class:"q-banner__content col text-body2"},R(b.default))],u=R(b.action);return u!==void 0&&y.push(d("div",{class:q.value},u)),d("div",{class:_.value+(l.inlineActions===!1&&u!==void 0?" q-banner--top-padding":""),role:"alert"},y)}}}),je=L({name:"QPopupProxy",props:{...Ve,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(l,{slots:b,emit:s,attrs:g}){const{proxy:_}=G(),{$q:q}=_,y=A(!1),u=A(null),k=x(()=>parseInt(l.breakpoint,10)),{canShow:S}=ze({showing:y});function E(){return q.screen.width<k.value||q.screen.height<k.value?"dialog":"menu"}const C=A(E()),M=x(()=>C.value==="menu"?{maxHeight:"99vh"}:{});U(()=>E(),h=>{y.value!==!0&&(C.value=h)});function N(h){y.value=!0,s("show",h)}function w(h){y.value=!1,C.value=E(),s("hide",h)}return Object.assign(_,{show(h){S(h)===!0&&u.value.show(h)},hide(h){u.value.hide(h)},toggle(h){u.value.toggle(h)}}),H(_,"currentComponent",()=>({type:C.value,ref:u.value})),()=>{const h={ref:u,...M.value,...g,onShow:N,onHide:w};let P;return C.value==="dialog"?P=Te:(P=Le,Object.assign(h,{target:l.target,contextMenu:l.contextMenu,noParentEvent:!0,separateClosePopup:!0})),d(P,h,b.default)}}}),Re=L({name:"QField",inheritAttrs:!1,props:Ke,emits:Ae,setup(){return Ee(Pe())}}),Ue={class:"self-center full-width no-outline ellipsis",tabindex:"0"},We={__name:"GoalSelect",props:{modelValue:{type:Number,default:null},exceptId:{type:Number,default:null}},emits:["update:modelValue"],setup(l,{emit:b}){const s=l,g=x({get(){return s.modelValue},set(u){b("update:modelValue",u)}}),_=Me(),q=x(()=>s.modelValue?_.getItem(s.modelValue).name:null);function y(u){return u.id!==s.exceptId}return(u,k)=>(Fe(),Ne(Re,{modelValue:V(g),"onUpdate:modelValue":k[1]||(k[1]=S=>ne(g)?g.value=S:null),clearable:"","clear-icon":"close"},{control:F(()=>[Qe("div",Ue,Be(V(q)),1)]),append:F(()=>[z(p,{name:"keyboard_arrow_down"})]),default:F(()=>[z(je,{fit:"","auto-close":""},{default:F(()=>[z(Oe,null,{default:F(()=>[z(Ie,{selected:V(g),"onUpdate:selected":k[0]||(k[0]=S=>ne(g)?g.value=S:null),nodes:V(_).tree,filter:String(l.exceptId),"filter-method":y,"node-key":"id","label-key":"name",icon:"keyboard_arrow_right","no-selection-unset":"","default-expand-all":""},null,8,["selected","nodes","filter"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{We as _};
