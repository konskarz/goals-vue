import{Q as S,b as I}from"./QToolbar-42614659.js";import{c as D,a as g,h as C,Q as B,C as t,D as r,E as f,F as s,e as b,r as P,w as F,H as M,bP as $,L as l,K as H,G as T,M as V,N as K,bN as Y}from"./index-7e23eb14.js";import{f as E,g as G,h as j,u as L,d as O}from"./QTree-cff18bb9.js";import{Q as v,a as R}from"./QForm-ca9498ff.js";import{u as z,_ as A,a as x}from"./DateInput-df0c39f3.js";import"./use-form-05eaf2b9.js";import"./uid-11c26a05.js";import"./QMenu-91e6a34a.js";import"./scroll-8baf78f9.js";const J=D({name:"QToggle",props:{...E,icon:String,iconColor:String},emits:G,setup(d){function k(n,e){const m=g(()=>(n.value===!0?d.checkedIcon:e.value===!0?d.indeterminateIcon:d.uncheckedIcon)||d.icon),u=g(()=>n.value===!0?d.iconColor:null);return()=>[C("div",{class:"q-toggle__track"}),C("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},m.value!==void 0?[C(B,{name:m.value,color:u.value})]:void 0)]}return j("toggle",k)}}),_={__name:"NumberInput",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(d,{emit:k}){const n=d,e=g({get(){return n.modelValue},set(m){m>=0&&k("update:modelValue",m)}});return(m,u)=>(t(),r(v,{modelValue:e.value,"onUpdate:modelValue":u[2]||(u[2]=c=>e.value=c),modelModifiers:{number:!0},type:"number",min:"0","stack-label":""},{append:f(()=>[s(b,{round:"",label:"-1",onClick:u[0]||(u[0]=c=>e.value--)}),s(b,{round:"",label:"+1",onClick:u[1]||(u[1]=c=>e.value++)})]),_:1},8,["modelValue"]))}},W={class:"row q-col-gutter-lg"},ue={__name:"TaskView",props:{id:{type:String,required:!0}},setup(d){const n=parseInt(d.id),{item:e,original:m,path:u,persist:c,changed:q,remove:w,save:Q,back:U}=z(n,L(),{name:"",goal:null,planned:new Date().toISOString(),recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),i=P(!1),N=g(()=>!e.value.name||!e.value.planned||c.value||!!(n&&!q(m,{...e.value}))),y=g(()=>{const p=e.value.performance_history;return!p||!p.length?null:p.map(a=>O.formatDate(a.updated,"DD.MM.YYYY HH:mm")+" to "+a.value).join(", ")});return F(i,p=>{u.value=p?"recurring/"+e.value.group_id+"/":n+"/"}),(p,a)=>(t(),M(H,null,[s(S,{class:"q-pl-lg"},{default:f(()=>[i.value?(t(),r(I,{key:1},{default:f(()=>[T("Group")]),_:1})):(t(),r(I,{key:0},{default:f(()=>[T("Task")]),_:1})),l(e).group_id?(t(),r(J,{key:2,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=o=>i.value=o),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):V("",!0),l(n)?(t(),r(b,{key:3,flat:"",round:"",icon:"delete",disable:l(c),onClick:l(w)},null,8,["disable","onClick"])):V("",!0),s(b,{flat:"",round:"",icon:"save",disable:N.value,onClick:l(Q)},null,8,["disable","onClick"]),s(b,{flat:"",round:"",icon:"clear",onClick:l(U)},null,8,["onClick"])]),_:1}),s(R,{class:"q-pt-sm q-px-lg",onSubmit:$(l(Q),["prevent"])},{default:f(()=>[K("div",W,[s(v,{modelValue:l(e).name,"onUpdate:modelValue":a[1]||(a[1]=o=>l(e).name=o),label:"Name","stack-label":"",autofocus:!l(n),rules:[o=>!!o||"Field is required"],class:"col-12 col-md-6",onKeyup:Y(l(U),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),s(A,{modelValue:l(e).goal,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).goal=o),label:"Goal","stack-label":"",class:"col-12 col-md-6"},null,8,["modelValue"]),i.value?V("",!0):(t(),r(x,{key:0,modelValue:l(e).planned,"onUpdate:modelValue":a[3]||(a[3]=o=>l(e).planned=o),label:"Planned",class:"col-12 col-md-6",rules:[o=>!!o||"Field is required"]},null,8,["modelValue","rules"])),l(n)?(t(),r(x,{key:1,modelValue:l(e).done,"onUpdate:modelValue":a[4]||(a[4]=o=>l(e).done=o),label:"Done",class:"col-12 col-md-6"},null,8,["modelValue"])):(t(),r(x,{key:2,modelValue:l(e).recurring_until,"onUpdate:modelValue":a[5]||(a[5]=o=>l(e).recurring_until=o),label:"Recurring until",class:"col-12 col-md-6"},null,8,["modelValue"])),s(_,{modelValue:l(e).target,"onUpdate:modelValue":a[6]||(a[6]=o=>l(e).target=o),label:"Target",class:"col-12 col-md-6"},null,8,["modelValue"]),i.value?V("",!0):(t(),r(_,{key:3,modelValue:l(e).performance,"onUpdate:modelValue":a[7]||(a[7]=o=>l(e).performance=o),label:"Performance",class:"col-12 col-md-6"},null,8,["modelValue"])),s(v,{modelValue:l(e).description,"onUpdate:modelValue":a[8]||(a[8]=o=>l(e).description=o),type:"textarea",label:"Description","stack-label":"",class:"col-12"},null,8,["modelValue"]),y.value&&!i.value?(t(),r(v,{key:4,modelValue:y.value,"onUpdate:modelValue":a[9]||(a[9]=o=>y.value=o),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"col-12"},null,8,["modelValue"])):V("",!0)])]),_:1},8,["onSubmit"])],64))}};export{ue as default};
