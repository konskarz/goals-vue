import{Q as S,c as _}from"./uid-9b8aee45.js";import{Q as I}from"./QToggle-65b853b4.js";import{j as U,P as u,R as n,S as p,T as r,a4 as V,W as e,ac as N,a1 as M,r as R,w as Y,U as q,$ as f,ad as C,ae as H,a8 as K}from"./index-f1bb3a23.js";import{Q as g,a as F}from"./QForm-43af9b49.js";import{Q as G,_ as j}from"./GoalSelect-ecd04ffe.js";import{u as W,d as z}from"./TaskStore-4648e463.js";import{u as A,_ as T}from"./DateInput-3237700a.js";import"./use-field-292924d2.js";import"./QSlideTransition-b91407e9.js";const w={__name:"NumberInput",props:{label:{type:String,required:!0},modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(k,{emit:y}){const v=k,t=U({get(){return v.modelValue},set(l){l>=0&&y("update:modelValue",l)}});return(l,d)=>(u(),n(g,{modelValue:e(t),"onUpdate:modelValue":d[2]||(d[2]=c=>N(t)?t.value=c:null),modelModifiers:{number:!0},type:"number",min:"0",label:k.label,"stack-label":""},{append:p(()=>[r(V,{round:"",label:"-1",onClick:d[0]||(d[0]=c=>t.value--)}),r(V,{round:"",label:"+1",onClick:d[1]||(d[1]=c=>t.value++)})]),_:1},8,["modelValue","label"]))}},E={class:"q-px-lg q-py-sm"},J={class:"row q-col-gutter-lg"},te={__name:"TaskView",setup(k){const y=M(),v=W(),t=parseInt(y.params.id),{item:l,original:d,path:c,persist:Q,changed:P,remove:$,save:B,back:x}=A(t,v,{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),m=R(!1),D=U(()=>!l.value.name||Q.value||!!(t&&!P(d,{...l.value}))),b=U(()=>{const s=l.value.performance_history;if(!s||!s.length)return null;const o=i=>z.formatDate(i.updated,"DD.MM.YYYY HH:mm")+" to "+i.value;let a=o(s[0]);if(s.length===1)return a;for(let i=1;i<s.length;i++)a+=", "+o(s[i]);return a});return Y(m,s=>{c.value=s?"recurring/"+l.value.group_id+"/":t+"/"}),(s,o)=>(u(),n(G,null,{default:p(()=>[r(F,{onSubmit:K(e(B),["prevent"])},{default:p(()=>[r(S,{class:"q-mt-md q-pl-lg"},{default:p(()=>[m.value?(u(),n(_,{key:1},{default:p(()=>[q("Group")]),_:1})):(u(),n(_,{key:0},{default:p(()=>[q("Task")]),_:1})),e(l).group_id?(u(),n(I,{key:2,modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=a=>m.value=a),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):f("",!0),e(t)?(u(),n(V,{key:3,type:"button",flat:"",round:"",icon:"delete",disable:e(Q),onClick:e($)},null,8,["disable","onClick"])):f("",!0),r(V,{type:"submit",flat:"",round:"",icon:"save",disable:e(D)},null,8,["disable"]),r(V,{type:"button",flat:"",round:"",icon:"clear",onClick:e(x)},null,8,["onClick"])]),_:1}),C("div",E,[C("div",J,[r(g,{modelValue:e(l).name,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(t),rules:[a=>!!a||"Field is required"],class:"col-12 col-lg-6",onKeyup:H(e(x),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),r(j,{modelValue:e(l).goal,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-lg-6"},null,8,["modelValue"]),m.value?f("",!0):(u(),n(T,{key:0,modelValue:e(l).planned,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).planned=a),label:"Planned",class:"col-12 col-lg-6"},null,8,["modelValue"])),e(t)?(u(),n(T,{key:1,modelValue:e(l).done,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).done=a),label:"Done",class:"col-12 col-lg-6"},null,8,["modelValue"])):(u(),n(T,{key:2,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-lg-6"},null,8,["modelValue"])),r(w,{modelValue:e(l).target,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).target=a),label:"Target",class:"col-12 col-lg-6"},null,8,["modelValue"]),m.value?f("",!0):(u(),n(w,{key:3,modelValue:e(l).performance,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-lg-6"},null,8,["modelValue"]))]),r(g,{modelValue:e(l).description,"onUpdate:modelValue":o[8]||(o[8]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(b)?(u(),n(g,{key:0,modelValue:e(b),"onUpdate:modelValue":o[9]||(o[9]=a=>N(b)?b.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):f("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{te as default};
