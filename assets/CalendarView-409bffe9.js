import{b as M,a as Q,Q as V}from"./api.client-fa8d94de.js";import{Q as v,_ as x}from"./WeekTimelineEntry-1849ed36.js";import{Q as F}from"./QPage-cbf7f1b9.js";import{d as e}from"./date-f0a783b1.js";import{_ as I}from"./GoalSelect-1b280c27.js";import{r as C,f as E,o as B,w as G,a0 as i,a1 as m,a5 as r,a6 as f,a8 as L,ax as c,a9 as g,aa as N,ab as y,ay as w}from"./index-b5c29f4c.js";import"./QList-1ba35af4.js";import"./format-711c199f.js";import"./QItemLabel-1d641f82.js";import"./NumberInput-72b2b463.js";import"./DurationInput-c9a46e4e.js";import"./QMenu-6b975687.js";const J={__name:"CalendarView",setup(O){const u="Goal-Filter",k=e.formatDate(new Date,"YYYY-w"),l=C(null),{data:D,mutate:T}=M.read("/tasks/"),_=E(()=>{const a=D.value.length,o=a?[...D.value].sort((d,h)=>Date.parse(d.planned)-Date.parse(h.planned)):null,t=a?new Date(o[0].planned):new Date,n=a?new Date(o[o.length-1].planned):e.addToDate(t,{days:7}),Y=e.addToDate(n,{days:7});let s=e.subtractFromDate(t,{days:e.getDayOfWeek(t)-1});const b=e.subtractFromDate(Y,{days:e.getDayOfWeek(Y)-1});let p={};for(;s<=b;)p[e.formatDate(s,"YYYY-w")]={day:e.formatDate(s,"YYYY-MM-DD"),tasks:[]},s=e.addToDate(s,{days:7});return a&&o.forEach(d=>{p[e.formatDate(d.planned,"YYYY-w")].tasks.push(d)}),p});return B(()=>{const a=localStorage.getItem(u);a&&(l.value=parseInt(a))}),G(l,a=>{a?localStorage.setItem(u,a):localStorage.removeItem(u)}),(a,o)=>(r(),i(F,{padding:""},{default:m(()=>[f(V,null,{default:m(()=>[f(Q,null,{default:m(()=>[L("Tasks")]),_:1}),f(I,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),label:"For Goal",dense:"",borderless:"",class:"col-6 col-sm-3 col-lg-2"},null,8,["modelValue"])]),_:1}),c(_)?(r(),i(v,{key:0,layout:"dense",class:"q-px-md"},{default:m(()=>[(r(!0),g(y,null,N(c(_),(t,n)=>(r(),g(y,{key:n},[t.day?(r(),i(x,{key:0,color:n===c(k)?"orange":"",week:t,onMutate:c(T)},null,8,["color","week","onMutate"])):w("",!0)],64))),128))]),_:1})):w("",!0)]),_:1}))}};export{J as default};
