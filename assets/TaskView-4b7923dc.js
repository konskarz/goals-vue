import{Q as P,a as x}from"./QToolbar-416b80ce.js";import{Q as S}from"./QToggle-93bd2660.js";import{j as T,R as t,S as u,T as c,U as n,V as b,r as $,w as I,W as _,a5 as a,a3 as V,a8 as q,ae as M,a6 as Y}from"./index-706be925.js";import{Q as k,a as H}from"./QForm-402dc4af.js";import{Q as K}from"./GoalStore-af331864.js";import{d as F}from"./date-decbebd2.js";import{u as G}from"./TaskStore-449bcc6d.js";import{u as R,_ as y}from"./DateInput-a9746e6e.js";import{_ as j}from"./GoalSelect-12b19590.js";import"./use-field-8b778ff9.js";import"./use-dark-1fecd9bd.js";import"./uid-6a237b22.js";import"./focus-manager-4e5c0bab.js";import"./format-8c778330.js";import"./QSlideTransition-8f381685.js";import"./use-prevent-scroll-24feb609.js";import"./use-model-toggle-58b014e9.js";const C={__name:"NumberInput",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(g,{emit:U}){const s=g,e=T({get(){return s.modelValue},set(f){f>=0&&U("update:modelValue",f)}});return(f,m)=>(t(),u(k,{modelValue:e.value,"onUpdate:modelValue":m[2]||(m[2]=i=>e.value=i),modelModifiers:{number:!0},type:"number",min:"0","stack-label":""},{append:c(()=>[n(b,{round:"",label:"-1",onClick:m[0]||(m[0]=i=>e.value--)}),n(b,{round:"",label:"+1",onClick:m[1]||(m[1]=i=>e.value++)})]),_:1},8,["modelValue"]))}},W={class:"q-py-sm q-px-lg"},z={class:"row q-col-gutter-lg"},me={__name:"TaskView",props:{id:{type:String,required:!0}},setup(g){const s=parseInt(g.id),{item:e,original:f,path:m,persist:i,changed:w,remove:N,save:B,back:Q}=R(s,G(),{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),d=$(!1),D=T(()=>!e.value.name||i.value||!!(s&&!w(f,{...e.value}))),v=T(()=>{const r=e.value.performance_history;if(!r||!r.length)return null;const o=p=>F.formatDate(p.updated,"DD.MM.YYYY HH:mm")+" to "+p.value;let l=o(r[0]);if(r.length===1)return l;for(let p=1;p<r.length;p++)l+=", "+o(r[p]);return l});return I(d,r=>{m.value=r?"recurring/"+e.value.group_id+"/":s+"/"}),(r,o)=>(t(),u(K,null,{default:c(()=>[n(H,{onSubmit:Y(a(B),["prevent"])},{default:c(()=>[n(P,{class:"q-mt-md q-pl-lg"},{default:c(()=>[d.value?(t(),u(x,{key:1},{default:c(()=>[_("Group")]),_:1})):(t(),u(x,{key:0},{default:c(()=>[_("Task")]),_:1})),a(e).group_id?(t(),u(S,{key:2,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=l=>d.value=l),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):V("",!0),a(s)?(t(),u(b,{key:3,type:"button",flat:"",round:"",icon:"delete",disable:a(i),onClick:a(N)},null,8,["disable","onClick"])):V("",!0),n(b,{type:"submit",flat:"",round:"",icon:"save",disable:D.value},null,8,["disable"]),n(b,{type:"button",flat:"",round:"",icon:"clear",onClick:a(Q)},null,8,["onClick"])]),_:1}),q("div",W,[q("div",z,[n(k,{modelValue:a(e).name,"onUpdate:modelValue":o[1]||(o[1]=l=>a(e).name=l),label:"Name","stack-label":"",autofocus:!a(s),rules:[l=>!!l||"Field is required"],class:"col-12 col-sm-6",onKeyup:M(a(Q),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),n(j,{modelValue:a(e).goal,"onUpdate:modelValue":o[2]||(o[2]=l=>a(e).goal=l),label:"Goal","stack-label":"",class:"col-12 col-sm-6"},null,8,["modelValue"]),d.value?V("",!0):(t(),u(y,{key:0,modelValue:a(e).planned,"onUpdate:modelValue":o[3]||(o[3]=l=>a(e).planned=l),label:"Planned",class:"col-12 col-sm-6"},null,8,["modelValue"])),a(s)?(t(),u(y,{key:1,modelValue:a(e).done,"onUpdate:modelValue":o[4]||(o[4]=l=>a(e).done=l),label:"Done",class:"col-12 col-sm-6"},null,8,["modelValue"])):(t(),u(y,{key:2,modelValue:a(e).recurring_until,"onUpdate:modelValue":o[5]||(o[5]=l=>a(e).recurring_until=l),label:"Recurring until",class:"col-12 col-sm-6"},null,8,["modelValue"])),n(C,{modelValue:a(e).target,"onUpdate:modelValue":o[6]||(o[6]=l=>a(e).target=l),label:"Target",class:"col-12 col-sm-6"},null,8,["modelValue"]),d.value?V("",!0):(t(),u(C,{key:3,modelValue:a(e).performance,"onUpdate:modelValue":o[7]||(o[7]=l=>a(e).performance=l),label:"Performance",class:"col-12 col-sm-6"},null,8,["modelValue"]))]),n(k,{modelValue:a(e).description,"onUpdate:modelValue":o[8]||(o[8]=l=>a(e).description=l),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),v.value&&!d.value?(t(),u(k,{key:0,modelValue:v.value,"onUpdate:modelValue":o[9]||(o[9]=l=>v.value=l),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):V("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{me as default};
