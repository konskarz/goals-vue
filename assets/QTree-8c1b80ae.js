import{c as fe,o as Ve,b as T,T as Be,r as Z,cf as Re,cg as Te,ch as Ye,ci as Ze,cj as we,a as Y,g as _e,b$ as je,n as Qe,d as We,b_ as Pe,bj as U,bY as te,Q as ue,aP as Ue,w as be,aK as Xe,ck as Je,cl as Ge,bJ as et,bB as tt,c9 as ke}from"./index-ad79f6fd.js";import{a as Ie,u as $e}from"./QToolbar-d3f5c8d8.js";import{u as nt,a as rt}from"./use-form-9ab9600f.js";const at=fe({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:t,emit:n}){let r=!1,l,a,d=null,s=null,c,$;function o(){l&&l(),l=null,r=!1,d!==null&&(clearTimeout(d),d=null),s!==null&&(clearTimeout(s),s=null),a!==void 0&&a.removeEventListener("transitionend",c),c=null}function y(m,_,k){_!==void 0&&(m.style.height=`${_}px`),m.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,r=!0,l=k}function q(m,_){m.style.overflowY=null,m.style.height=null,m.style.transition=null,o(),_!==$&&n(_)}function p(m,_){let k=0;a=m,r===!0?(o(),k=m.offsetHeight===m.scrollHeight?0:void 0):($="hide",m.style.overflowY="hidden"),y(m,k,_),d=setTimeout(()=>{d=null,m.style.height=`${m.scrollHeight}px`,c=K=>{s=null,(Object(K)!==K||K.target===m)&&q(m,"show")},m.addEventListener("transitionend",c),s=setTimeout(c,e.duration*1.1)},100)}function M(m,_){let k;a=m,r===!0?o():($="show",m.style.overflowY="hidden",k=m.scrollHeight),y(m,k,_),d=setTimeout(()=>{d=null,m.style.height=0,c=K=>{s=null,(Object(K)!==K||K.target===m)&&q(m,"hide")},m.addEventListener("transitionend",c),s=setTimeout(c,e.duration*1.1)},100)}return Ve(()=>{r===!0&&o()}),()=>T(Be,{css:!1,appear:e.appear,onEnter:p,onLeave:M},t.default)}});function lt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Qt(e,t,n){return n<=t?t:Math.min(n,Math.max(t,e))}function A(e,t=2,n="0"){if(e==null)return e;const r=""+e;return r.length>=t?r:new Array(t-r.length+1).join(n)+r}function Ce(e){const t=e+"/",{request:n,get:r}=Re(),l=Z(JSON.parse(localStorage.getItem(e)));function a(){r(t).then(o=>{l.value=o,localStorage.setItem(e,JSON.stringify(o))})}function d(o){return l.value.find(y=>y.id===o)}function s(o){return n({method:"post",url:t,data:o})}function c(o,y){return n({method:"patch",url:t+o+"/",data:y})}function $(o){return n({method:"delete",url:t+o+"/"})}return a(),{data:l,refetch:a,getItem:d,createItem:s,updateItem:c,deleteItem:$}}const G=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function it(e){return st(e)===0}function ut(e,t){return t<=6?31:t<=11||it(e)?30:29}function st(e){const t=G.length;let n=G[0],r,l,a,d,s;if(e<n||e>=G[t-1])throw new Error("Invalid Jalaali year "+e);for(s=1;s<t&&(r=G[s],l=r-n,!(e<r));s+=1)n=r;return d=e-n,l-d<6&&(d=d-l+ot(l+4,33)*33),a=Me(Me(d+1,33)-1,4),a===-1&&(a=4),a}function ot(e,t){return~~(e/t)}function Me(e,t){return e-~~(e/t)*t}const qe=864e5,ct=36e5,se=6e4,Oe="YYYY-MM-DDTHH:mm:ss.SSSZ",dt=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,ft=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,le={};function ht(e,t){const n="("+t.days.join("|")+")",r=e+n;if(le[r]!==void 0)return le[r];const l="("+t.daysShort.join("|")+")",a="("+t.months.join("|")+")",d="("+t.monthsShort.join("|")+")",s={};let c=0;const $=e.replace(ft,y=>{switch(c++,y){case"YY":return s.YY=c,"(-?\\d{1,2})";case"YYYY":return s.YYYY=c,"(-?\\d{1,4})";case"M":return s.M=c,"(\\d{1,2})";case"MM":return s.M=c,"(\\d{2})";case"MMM":return s.MMM=c,d;case"MMMM":return s.MMMM=c,a;case"D":return s.D=c,"(\\d{1,2})";case"Do":return s.D=c++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return s.D=c,"(\\d{2})";case"H":return s.H=c,"(\\d{1,2})";case"HH":return s.H=c,"(\\d{2})";case"h":return s.h=c,"(\\d{1,2})";case"hh":return s.h=c,"(\\d{2})";case"m":return s.m=c,"(\\d{1,2})";case"mm":return s.m=c,"(\\d{2})";case"s":return s.s=c,"(\\d{1,2})";case"ss":return s.s=c,"(\\d{2})";case"S":return s.S=c,"(\\d{1})";case"SS":return s.S=c,"(\\d{2})";case"SSS":return s.S=c,"(\\d{3})";case"A":return s.A=c,"(AM|PM)";case"a":return s.a=c,"(am|pm)";case"aa":return s.aa=c,"(a\\.m\\.|p\\.m\\.)";case"ddd":return l;case"dddd":return n;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return s.Z=c,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return s.ZZ=c,"(Z|[+-]\\d{2}\\d{2})";case"X":return s.X=c,"(-?\\d+)";case"x":return s.x=c,"(-?\\d{4,})";default:return c--,y[0]==="["&&(y=y.substring(1,y.length-1)),y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),o={map:s,regex:new RegExp("^"+$)};return le[r]=o,o}function Ee(e,t){return e!==void 0?e:t!==void 0?t.date:Ze.date}function Se(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),l=Math.floor(r/60),a=r%60;return n+A(l)+t+A(a)}function gt(e,t,n){let r=e.getFullYear(),l=e.getMonth();const a=e.getDate();return t.year!==void 0&&(r+=n*t.year,delete t.year),t.month!==void 0&&(l+=n*t.month,delete t.month),e.setDate(1),e.setMonth(2),e.setFullYear(r),e.setMonth(l),e.setDate(Math.min(a,ge(e))),t.date!==void 0&&(e.setDate(e.getDate()+n*t.date),delete t.date),e}function vt(e,t,n){const r=t.year!==void 0?t.year:e[`get${n}FullYear`](),l=t.month!==void 0?t.month-1:e[`get${n}Month`](),a=new Date(r,l+1,0).getDate(),d=Math.min(a,t.date!==void 0?t.date:e[`get${n}Date`]());return e[`set${n}Date`](1),e[`set${n}Month`](2),e[`set${n}FullYear`](r),e[`set${n}Month`](l),e[`set${n}Date`](d),delete t.year,delete t.month,delete t.date,e}function he(e,t,n){const r=Fe(t),l=new Date(e),a=r.year!==void 0||r.month!==void 0||r.date!==void 0?gt(l,r,n):l;for(const d in r){const s=lt(d);a[`set${s}`](a[`get${s}`]()+n*r[d])}return a}function Fe(e){const t={...e};return e.years!==void 0&&(t.year=e.years,delete t.years),e.months!==void 0&&(t.month=e.months,delete t.months),e.days!==void 0&&(t.date=e.days,delete t.days),e.day!==void 0&&(t.date=e.day,delete t.day),e.hour!==void 0&&(t.hours=e.hour,delete t.hour),e.minute!==void 0&&(t.minutes=e.minute,delete t.minute),e.second!==void 0&&(t.seconds=e.second,delete t.second),e.millisecond!==void 0&&(t.milliseconds=e.millisecond,delete t.millisecond),t}function Ae(e,t,n){const r=Fe(t),l=n===!0?"UTC":"",a=new Date(e),d=r.year!==void 0||r.month!==void 0||r.date!==void 0?vt(a,r,l):a;for(const s in r){const c=s.charAt(0).toUpperCase()+s.slice(1);d[`set${l}${c}`](r[s])}return d}function yt(e,t,n){const r=mt(e,t,n),l=new Date(r.year,r.month===null?null:r.month-1,r.day===null?1:r.day,r.hour,r.minute,r.second,r.millisecond),a=l.getTimezoneOffset();return r.timezoneOffset===null||r.timezoneOffset===a?l:he(l,{minutes:r.timezoneOffset-a},1)}function mt(e,t,n,r,l){const a={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(l!==void 0&&Object.assign(a,l),e==null||e===""||typeof e!="string")return a;t===void 0&&(t=Oe);const d=Ee(n,Te.props),s=d.months,c=d.monthsShort,{regex:$,map:o}=ht(t,d),y=e.match($);if(y===null)return a;let q="";if(o.X!==void 0||o.x!==void 0){const p=parseInt(y[o.X!==void 0?o.X:o.x],10);if(isNaN(p)===!0||p<0)return a;const M=new Date(p*(o.X!==void 0?1e3:1));a.year=M.getFullYear(),a.month=M.getMonth()+1,a.day=M.getDate(),a.hour=M.getHours(),a.minute=M.getMinutes(),a.second=M.getSeconds(),a.millisecond=M.getMilliseconds()}else{if(o.YYYY!==void 0)a.year=parseInt(y[o.YYYY],10);else if(o.YY!==void 0){const p=parseInt(y[o.YY],10);a.year=p<0?p:2e3+p}if(o.M!==void 0){if(a.month=parseInt(y[o.M],10),a.month<1||a.month>12)return a}else o.MMM!==void 0?a.month=c.indexOf(y[o.MMM])+1:o.MMMM!==void 0&&(a.month=s.indexOf(y[o.MMMM])+1);if(o.D!==void 0){if(a.day=parseInt(y[o.D],10),a.year===null||a.month===null||a.day<1)return a;const p=r!=="persian"?new Date(a.year,a.month,0).getDate():ut(a.year,a.month);if(a.day>p)return a}o.H!==void 0?a.hour=parseInt(y[o.H],10)%24:o.h!==void 0&&(a.hour=parseInt(y[o.h],10)%12,(o.A&&y[o.A]==="PM"||o.a&&y[o.a]==="pm"||o.aa&&y[o.aa]==="p.m.")&&(a.hour+=12),a.hour=a.hour%24),o.m!==void 0&&(a.minute=parseInt(y[o.m],10)%60),o.s!==void 0&&(a.second=parseInt(y[o.s],10)%60),o.S!==void 0&&(a.millisecond=parseInt(y[o.S],10)*10**(3-y[o.S].length)),(o.Z!==void 0||o.ZZ!==void 0)&&(q=o.Z!==void 0?y[o.Z].replace(":",""):y[o.ZZ],a.timezoneOffset=(q[0]==="+"?-1:1)*(60*q.slice(1,3)+1*q.slice(3,5)))}return a.dateHash=A(a.year,6)+"/"+A(a.month)+"/"+A(a.day),a.timeHash=A(a.hour)+":"+A(a.minute)+":"+A(a.second)+q,a}function Dt(e){return typeof e=="number"?!0:isNaN(Date.parse(e))===!1}function bt(e,t){return Ae(new Date,e,t)}function kt(e){const t=new Date(e).getDay();return t===0?7:t}function oe(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);const n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);const r=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-r);const l=(t-n)/(qe*7);return 1+Math.floor(l)}function Mt(e){return e.getFullYear()*1e4+e.getMonth()*100+e.getDate()}function ie(e,t){const n=new Date(e);return t===!0?Mt(n):n.getTime()}function St(e,t,n,r={}){const l=ie(t,r.onlyDate),a=ie(n,r.onlyDate),d=ie(e,r.onlyDate);return(d>l||r.inclusiveFrom===!0&&d===l)&&(d<a||r.inclusiveTo===!0&&d===a)}function xt(e,t){return he(e,t,1)}function pt(e,t){return he(e,t,-1)}function R(e,t,n){const r=new Date(e),l=`set${n===!0?"UTC":""}`;switch(t){case"year":case"years":r[`${l}Month`](0);case"month":case"months":r[`${l}Date`](1);case"day":case"days":case"date":r[`${l}Hours`](0);case"hour":case"hours":r[`${l}Minutes`](0);case"minute":case"minutes":r[`${l}Seconds`](0);case"second":case"seconds":r[`${l}Milliseconds`](0)}return r}function Tt(e,t,n){const r=new Date(e),l=`set${n===!0?"UTC":""}`;switch(t){case"year":case"years":r[`${l}Month`](11);case"month":case"months":r[`${l}Date`](ge(r));case"day":case"days":case"date":r[`${l}Hours`](23);case"hour":case"hours":r[`${l}Minutes`](59);case"minute":case"minutes":r[`${l}Seconds`](59);case"second":case"seconds":r[`${l}Milliseconds`](999)}return r}function Yt(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(n=>{t=Math.max(t,new Date(n))}),t}function wt(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(n=>{t=Math.min(t,new Date(n))}),t}function ee(e,t,n){return(e.getTime()-e.getTimezoneOffset()*se-(t.getTime()-t.getTimezoneOffset()*se))/n}function He(e,t,n="days"){const r=new Date(e),l=new Date(t);switch(n){case"years":case"year":return r.getFullYear()-l.getFullYear();case"months":case"month":return(r.getFullYear()-l.getFullYear())*12+r.getMonth()-l.getMonth();case"days":case"day":case"date":return ee(R(r,"day"),R(l,"day"),qe);case"hours":case"hour":return ee(R(r,"hour"),R(l,"hour"),ct);case"minutes":case"minute":return ee(R(r,"minute"),R(l,"minute"),se);case"seconds":case"second":return ee(R(r,"second"),R(l,"second"),1e3)}}function ce(e){return He(e,R(e,"year"),"days")+1}function _t(e){return Ye(e)===!0?"date":typeof e=="number"?"number":"string"}function It(e,t,n){const r=new Date(e);if(t){const l=new Date(t);if(r<l)return l}if(n){const l=new Date(n);if(r>l)return l}return r}function $t(e,t,n){const r=new Date(e),l=new Date(t);if(n===void 0)return r.getTime()===l.getTime();switch(n){case"second":case"seconds":if(r.getSeconds()!==l.getSeconds())return!1;case"minute":case"minutes":if(r.getMinutes()!==l.getMinutes())return!1;case"hour":case"hours":if(r.getHours()!==l.getHours())return!1;case"day":case"days":case"date":if(r.getDate()!==l.getDate())return!1;case"month":case"months":if(r.getMonth()!==l.getMonth())return!1;case"year":case"years":if(r.getFullYear()!==l.getFullYear())return!1;break;default:throw new Error(`date isSameDate unknown unit ${n}`)}return!0}function ge(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function xe(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const pe={YY(e,t,n){const r=this.YYYY(e,t,n)%100;return r>=0?A(r):"-"+A(Math.abs(r))},YYYY(e,t,n){return n??e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return A(e.getMonth()+1)},MMM(e,t){return t.monthsShort[e.getMonth()]},MMMM(e,t){return t.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return xe(this.Q(e))},D(e){return e.getDate()},Do(e){return xe(e.getDate())},DD(e){return A(e.getDate())},DDD(e){return ce(e)},DDDD(e){return A(ce(e),3)},d(e){return e.getDay()},dd(e,t){return this.dddd(e,t).slice(0,2)},ddd(e,t){return t.daysShort[e.getDay()]},dddd(e,t){return t.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return oe(e)},ww(e){return A(oe(e))},H(e){return e.getHours()},HH(e){return A(e.getHours())},h(e){const t=e.getHours();return t===0?12:t>12?t%12:t},hh(e){return A(this.h(e))},m(e){return e.getMinutes()},mm(e){return A(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return A(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return A(Math.floor(e.getMilliseconds()/10))},SSS(e){return A(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,t,n,r){const l=r??e.getTimezoneOffset();return Se(l,":")},ZZ(e,t,n,r){const l=r??e.getTimezoneOffset();return Se(l)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function Ct(e,t,n,r,l){if(e!==0&&!e||e===1/0||e===-1/0)return;const a=new Date(e);if(isNaN(a))return;t===void 0&&(t=Oe);const d=Ee(n,Te.props);return t.replace(dt,(s,c)=>s in pe?pe[s](a,d,r,l):c===void 0?s:c.split("\\]").join("]"))}function qt(e){return Ye(e)===!0?new Date(e.getTime()):e}const E={isValid:Dt,extractDate:yt,buildDate:bt,getDayOfWeek:kt,getWeekOfYear:oe,isBetweenDates:St,addToDate:xt,subtractFromDate:pt,adjustDate:Ae,startOfDate:R,endOfDate:Tt,getMaxDate:Yt,getMinDate:wt,getDateDiff:He,getDayOfYear:ce,inferDateFormat:_t,getDateBetween:It,isSameDate:$t,daysInMonth:ge,formatDate:Ct,clone:qt};function Ot(){const e=v=>E.startOfDate(v,"day"),t=v=>E.subtractFromDate(v,{days:E.getDayOfWeek(v)-1}),n=v=>E.subtractFromDate(v,{days:7}),r=v=>E.subtractFromDate(v,{days:1}),l=v=>E.addToDate(v,{days:7}),a=v=>E.formatDate(v,"YYYY-MM-DD"),d=e(new Date),s=t(d),c=E.addToDate(s,{days:6}),$=E.subtractFromDate(d,{months:6}),o=v=>e(v)<s,y=v=>e(v)>c,q=v=>E.isBetweenDates(e(v),$,d),p=v=>e(v)<=d,M=(v,I)=>{const O=[];return E.isSameDate(v,I,"year")?(O.push(E.formatDate(v,E.isSameDate(v,I,"month")?"D–":"D MMM – ")),O.push(E.formatDate(I,"D MMM"))):(O.push(E.formatDate(v,"D MMM YYYY – ")),O.push(E.formatDate(I,"D MMM YYYY"))),O.join("")},m=(v,I)=>({title:M(v,I),current:E.isSameDate(v,s,"day"),start:!E.isSameDate(v,n(v),"month"),month:E.formatDate(v,"MMMM YYYY"),tasks:[]});function _(v){const I={},O=l(t(e(v[v.length-1].planned)));let z,N=t(e(v[0].planned)),h=r(N);for(;N<=O;)z=l(h),I[a(N)]=m(N,z),N=l(N),h=z;return v.forEach(S=>{I[a(t(S.planned))].tasks.push(S)}),I}function k(v){return v.reduce((I,O)=>{const z=t(e(O.planned)),N=l(r(z)),h=a(z);return I[h]||(I[h]=m(z,N)),I[h].tasks.push(O),I},{})}function K(v){const I=(h,S,C)=>{for(;S<=C;)h.push({x:a(S),y:null}),S=l(S);return h},O=h=>h.done?100:h.target>1?Math.round(h.performance/h.target*100):0,z=t($),N=t(d);return v.reduce((h,S)=>{h[S.name]||(h[S.name]=I([],z,N));const C=a(t(S.planned));return h[S.name].find(D=>D.x===C).y=O(S),h},{})}function j(v,I){const O=E.getDayOfWeek(v)-1;return E.addToDate(I,{days:O})}return{beforeThisWeek:o,afterThisWeek:y,seriesRange:q,beforeThisDay:p,buildCalendar:_,buildAgenda:k,buildSeries:K,changeWeek:j}}const de=(e,t=null)=>e.filter(n=>n.parent===t).map(n=>({...n,children:de(e,n.id)})),Et=we("GoalStore",()=>{const{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a}=Ce("goals"),d=Ft(),s=Z([]),c=Z([]),$=Y(()=>!e.value||!d.data?null:e.value.map(p=>({...p,...d.getReport(q(p.id))}))),o=Y(()=>e.value?de(e.value):null),y=Y(()=>$.value?de($.value):null);function q(p){if(!p)return e.value.map(_=>_.id);const M=[p],m=_=>e.value.filter(k=>k.parent===_).forEach(k=>{M.push(k.id),m(k.id)});return m(p),M}return{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a,treeTicked:c,treeExpanded:s,tree:o,treeReport:y,getBranch:q}}),Ft=we("TaskStore",()=>{const{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a}=Ce("tasks"),{beforeThisWeek:d,afterThisWeek:s,seriesRange:c,beforeThisDay:$,buildCalendar:o,buildAgenda:y,buildSeries:q,changeWeek:p}=Ot(),M=Et();M.$onAction(({name:h,store:S,args:C})=>{h==="deleteItem"&&S.treeTicked.includes(C[0])&&S.treeTicked.splice(S.treeTicked.indexOf(C[0]),1)});const m=Y(()=>!e.value||!M.data?null:e.value.map(h=>({...h,goalName:h.goal?M.getItem(h.goal).name:null}))),_=Z({show:!1,pastDone:!1,pastRecurring:!1,futureRecurring:!1,emptyWeeks:!1}),k=Y(()=>e.value?e.value.filter(h=>!(!h.planned||d(h.planned)&&(!_.value.pastDone&&h.done||!_.value.pastRecurring&&h.group_id)||s(h.planned)&&!_.value.futureRecurring&&h.group_id||M.treeTicked.length&&!M.treeTicked.includes(h.goal))).sort((h,S)=>Date.parse(h.planned)-Date.parse(S.planned)):null),K=Y(()=>k.value&&k.value.length?_.value.emptyWeeks?o(k.value):y(k.value):null),j=Y(()=>e.value?O():null),v=Y(()=>{if(!k.value)return null;const h=I(k.value);return h.target>0||h.rperformance!==null?h:null});function I(h){const S=h.filter(L=>!L.group_id),C=S.filter(L=>L.done),D=h.filter(L=>L.group_id&&L.planned&&$(L.planned)),B=L=>L.reduce((X,Q)=>Q.done?X+1:Q.target>1?X+Q.performance/Q.target:X,0);return{target:S.length,performance:C.length,rtarget:D.length,rperformance:D.length?B(D):null,series:D.length?O([...new Set(D.map(L=>L.group_id))]):null}}function O(h){const S=e.value.filter(C=>!C.group_id||!C.planned||h&&h.length&&!h.includes(C.group_id)?!1:c(C.planned)).sort((C,D)=>Date.parse(C.planned)-Date.parse(D.planned));return S.length?q(S):null}function z(h){return I(e.value.filter(S=>h.includes(S.goal)))}function N(h,S){const C={planned:p(h.planned,S).toISOString()};l(h.id+"/",C).then(()=>t())}return{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a,relative:m,filter:_,filtered:k,calendar:K,series:j,report:v,getSeries:O,getReport:z,moveItem:N}});function At(e,t){const n=Z(null),r=Y(()=>e.disable===!0?null:T("span",{ref:n,class:"no-outline",tabindex:-1}));function l(a){const d=t.value;a!==void 0&&a.type.indexOf("key")===0?d!==null&&document.activeElement!==d&&d.contains(document.activeElement)===!0&&d.focus():n.value!==null&&(a===void 0||d!==null&&d.contains(a.target)===!0)&&n.value.focus()}return{refocusTargetEl:r,refocusTarget:l}}const Ht={xs:30,sm:35,md:40,lg:50,xl:60},Kt={...$e,...Pe,...nt,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},zt=["update:modelValue"];function Nt(e,t){const{props:n,slots:r,emit:l,proxy:a}=_e(),{$q:d}=a,s=Ie(n,d),c=Z(null),{refocusTargetEl:$,refocusTarget:o}=At(n,c),y=je(n,Ht),q=Y(()=>n.val!==void 0&&Array.isArray(n.modelValue)),p=Y(()=>{const D=U(n.val);return q.value===!0?n.modelValue.findIndex(B=>U(B)===D):-1}),M=Y(()=>q.value===!0?p.value>-1:U(n.modelValue)===U(n.trueValue)),m=Y(()=>q.value===!0?p.value===-1:U(n.modelValue)===U(n.falseValue)),_=Y(()=>M.value===!1&&m.value===!1),k=Y(()=>n.disable===!0?-1:n.tabindex||0),K=Y(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(n.disable===!0?" disabled":"")+(s.value===!0?` q-${e}--dark`:"")+(n.dense===!0?` q-${e}--dense`:"")+(n.leftLabel===!0?" reverse":"")),j=Y(()=>{const D=M.value===!0?"truthy":m.value===!0?"falsy":"indet",B=n.color!==void 0&&(n.keepColor===!0||(e==="toggle"?M.value===!0:m.value!==!0))?` text-${n.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${D}${B}`}),v=Y(()=>{const D={type:"checkbox"};return n.name!==void 0&&Object.assign(D,{".checked":M.value,"^checked":M.value===!0?"checked":void 0,name:n.name,value:q.value===!0?n.val:n.trueValue}),D}),I=rt(v),O=Y(()=>{const D={tabindex:k.value,role:e==="toggle"?"switch":"checkbox","aria-label":n.label,"aria-checked":_.value===!0?"mixed":M.value===!0?"true":"false"};return n.disable===!0&&(D["aria-disabled"]="true"),D});function z(D){D!==void 0&&(te(D),o(D)),n.disable!==!0&&l("update:modelValue",N(),D)}function N(){if(q.value===!0){if(M.value===!0){const D=n.modelValue.slice();return D.splice(p.value,1),D}return n.modelValue.concat([n.val])}if(M.value===!0){if(n.toggleOrder!=="ft"||n.toggleIndeterminate===!1)return n.falseValue}else if(m.value===!0){if(n.toggleOrder==="ft"||n.toggleIndeterminate===!1)return n.trueValue}else return n.toggleOrder!=="ft"?n.trueValue:n.falseValue;return n.indeterminateValue}function h(D){(D.keyCode===13||D.keyCode===32)&&te(D)}function S(D){(D.keyCode===13||D.keyCode===32)&&z(D)}const C=t(M,_);return Object.assign(a,{toggle:z}),()=>{const D=C();n.disable!==!0&&I(D,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const B=[T("div",{class:j.value,style:y.value,"aria-hidden":"true"},D)];$.value!==null&&B.push($.value);const L=n.label!==void 0?Qe(r.default,[n.label]):We(r.default);return L!==void 0&&B.push(T("div",{class:`q-${e}__label q-anchor--skip`},L)),T("div",{ref:c,class:K.value,...O.value,onClick:z,onKeydown:h,onKeyup:S},B)}}const Lt=T("div",{key:"svg",class:"q-checkbox__bg absolute"},[T("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[T("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),T("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Vt=fe({name:"QCheckbox",props:Kt,emits:zt,setup(e){function t(n,r){const l=Y(()=>(n.value===!0?e.checkedIcon:r.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>l.value!==null?[T("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[T(ue,{class:"q-checkbox__icon",name:l.value})])]:[Lt]}return Nt("checkbox",t)}}),Bt=["none","strict","leaf","leaf-filtered"],Wt=fe({name:"QTree",props:{...$e,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>Bt.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:t,emit:n}){const{proxy:r}=_e(),{$q:l}=r,a=Ie(e,l),d=Z({}),s=Z(e.ticked||[]),c=Z(e.expanded||[]);let $={};Ue(()=>{$={}});const o=Y(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(a.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),y=Y(()=>e.selected!==void 0),q=Y(()=>e.icon||l.iconSet.tree.icon),p=Y(()=>e.controlColor||e.color),M=Y(()=>e.textColor!==void 0?` text-${e.textColor}`:""),m=Y(()=>{const u=e.selectedColor||e.color;return u?` text-${u}`:""}),_=Y(()=>e.filterMethod!==void 0?e.filterMethod:(u,f)=>{const i=f.toLowerCase();return u[e.labelKey]&&u[e.labelKey].toLowerCase().indexOf(i)>-1}),k=Y(()=>{const u={},f=(i,b)=>{const g=i.tickStrategy||(b?b.tickStrategy:e.tickStrategy),w=i[e.nodeKey],F=i[e.childrenKey]&&Array.isArray(i[e.childrenKey])&&i[e.childrenKey].length!==0,W=i.disabled!==!0&&y.value===!0&&i.selectable!==!1,V=i.disabled!==!0&&i.expandable!==!1,Ne=g!=="none",J=g==="strict",me=g==="leaf-filtered",re=g==="leaf"||g==="leaf-filtered";let ae=i.disabled!==!0&&i.tickable!==!1;re===!0&&ae===!0&&b&&b.tickable!==!0&&(ae=!1);let P=i.lazy;P===!0&&d.value[w]!==void 0&&Array.isArray(i[e.childrenKey])===!0&&(P=d.value[w]);const x={key:w,parent:b,isParent:F,lazy:P,disabled:i.disabled,link:i.disabled!==!0&&(W===!0||V===!0&&(F===!0||P===!0)),children:[],matchesFilter:e.filter?_.value(i,e.filter):!0,selected:w===e.selected&&W===!0,selectable:W,expanded:F===!0?c.value.includes(w):!1,expandable:V,noTick:i.noTick===!0||J!==!0&&P&&P!=="loaded",tickable:ae,tickStrategy:g,hasTicking:Ne,strictTicking:J,leafFilteredTicking:me,leafTicking:re,ticked:J===!0?s.value.includes(w):F===!0?!1:s.value.includes(w)};if(u[w]=x,F===!0&&(x.children=i[e.childrenKey].map(H=>f(H,x)),e.filter&&(x.matchesFilter!==!0?x.matchesFilter=x.children.some(H=>H.matchesFilter):x.noTick!==!0&&x.disabled!==!0&&x.tickable===!0&&me===!0&&x.children.every(H=>H.matchesFilter!==!0||H.noTick===!0||H.tickable!==!0)===!0&&(x.tickable=!1)),x.matchesFilter===!0&&(x.noTick!==!0&&J!==!0&&x.children.every(H=>H.noTick)===!0&&(x.noTick=!0),re))){if(x.ticked=!1,x.indeterminate=x.children.some(H=>H.indeterminate===!0),x.tickable=x.tickable===!0&&x.children.some(H=>H.tickable),x.indeterminate!==!0){const H=x.children.reduce((De,Le)=>Le.ticked===!0?De+1:De,0);H===x.children.length?x.ticked=!0:H>0&&(x.indeterminate=!0)}x.indeterminate===!0&&(x.indeterminateNextState=x.children.every(H=>H.tickable!==!0||H.ticked!==!0))}return x};return e.nodes.forEach(i=>f(i,null)),u});be(()=>e.ticked,u=>{s.value=u}),be(()=>e.expanded,u=>{c.value=u});function K(u){const f=[].reduce,i=(b,g)=>{if(b||!g)return b;if(Array.isArray(g)===!0)return f.call(Object(g),i,b);if(g[e.nodeKey]===u)return g;if(g[e.childrenKey])return i(null,g[e.childrenKey])};return i(null,e.nodes)}function j(){return s.value.map(u=>K(u))}function v(){return c.value.map(u=>K(u))}function I(u){return u&&k.value[u]?k.value[u].expanded:!1}function O(){e.expanded!==void 0?n("update:expanded",[]):c.value=[]}function z(){const u=[],f=i=>{i[e.childrenKey]&&i[e.childrenKey].length!==0&&i.expandable!==!1&&i.disabled!==!0&&(u.push(i[e.nodeKey]),i[e.childrenKey].forEach(f))};e.nodes.forEach(f),e.expanded!==void 0?n("update:expanded",u):c.value=u}function N(u,f,i=K(u),b=k.value[u]){if(b.lazy&&b.lazy!=="loaded"){if(b.lazy==="loading")return;d.value[u]="loading",Array.isArray(i[e.childrenKey])!==!0&&(i[e.childrenKey]=[]),n("lazyLoad",{node:i,key:u,done:g=>{d.value[u]="loaded",i[e.childrenKey]=Array.isArray(g)===!0?g:[],Xe(()=>{const w=k.value[u];w&&w.isParent===!0&&h(u,!0)})},fail:()=>{delete d.value[u],i[e.childrenKey].length===0&&delete i[e.childrenKey]}})}else b.isParent===!0&&b.expandable===!0&&h(u,f)}function h(u,f){let i=c.value;const b=e.expanded!==void 0;if(b===!0&&(i=i.slice()),f){if(e.accordion&&k.value[u]){const g=[];k.value[u].parent?k.value[u].parent.children.forEach(w=>{w.key!==u&&w.expandable===!0&&g.push(w.key)}):e.nodes.forEach(w=>{const F=w[e.nodeKey];F!==u&&g.push(F)}),g.length!==0&&(i=i.filter(w=>g.includes(w)===!1))}i=i.concat([u]).filter((g,w,F)=>F.indexOf(g)===w)}else i=i.filter(g=>g!==u);b===!0?n("update:expanded",i):c.value=i}function S(u){return u&&k.value[u]?k.value[u].ticked:!1}function C(u,f){let i=s.value;const b=e.ticked!==void 0;b===!0&&(i=i.slice()),f?i=i.concat(u).filter((g,w,F)=>F.indexOf(g)===w):i=i.filter(g=>u.includes(g)===!1),b===!0&&n("update:ticked",i)}function D(u,f,i){const b={tree:r,node:u,key:i,color:e.color,dark:a.value};return ke(b,"expanded",()=>f.expanded,g=>{g!==f.expanded&&N(i,g)}),ke(b,"ticked",()=>f.ticked,g=>{g!==f.ticked&&C([i],g)}),b}function B(u){return(e.filter?u.filter(f=>k.value[f[e.nodeKey]].matchesFilter):u).map(f=>Ke(f))}function L(u){if(u.icon!==void 0)return T(ue,{class:"q-tree__icon q-mr-sm",name:u.icon,color:u.iconColor});const f=u.img||u.avatar;if(f)return T("img",{class:`q-tree__${u.img?"img":"avatar"} q-mr-sm`,src:f})}function X(){n("afterShow")}function Q(){n("afterHide")}function Ke(u){const f=u[e.nodeKey],i=k.value[f],b=u.header&&t[`header-${u.header}`]||t["default-header"],g=i.isParent===!0?B(u[e.childrenKey]):[],w=g.length!==0||i.lazy&&i.lazy!=="loaded";let F=u.body&&t[`body-${u.body}`]||t["default-body"];const W=b!==void 0||F!==void 0?D(u,i,f):null;return F!==void 0&&(F=T("div",{class:"q-tree__node-body relative-position"},[T("div",{class:M.value},[F(W)])])),T("div",{key:f,class:`q-tree__node relative-position q-tree__node--${w===!0?"parent":"child"}`},[T("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(i.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(i.selected===!0?" q-tree__node--selected":"")+(i.disabled===!0?" q-tree__node--disabled":""),tabindex:i.link===!0?0:-1,onClick:V=>{ye(u,i,V)},onKeypress(V){Je(V)!==!0&&(V.keyCode===13?ye(u,i,V,!0):V.keyCode===32&&ne(u,i,V,!0))}},[T("div",{class:"q-focus-helper",tabindex:-1,ref:V=>{$[i.key]=V}}),i.lazy==="loading"?T(Ge,{class:"q-tree__spinner",color:p.value}):w===!0?T(ue,{class:"q-tree__arrow"+(i.expanded===!0?" q-tree__arrow--rotate":""),name:q.value,onClick(V){ne(u,i,V)}}):null,i.hasTicking===!0&&i.noTick!==!0?T(Vt,{class:"q-tree__tickbox",modelValue:i.indeterminate===!0?null:i.ticked,color:p.value,dark:a.value,dense:!0,keepColor:!0,disable:i.tickable!==!0,onKeydown:te,"onUpdate:modelValue":V=>{ze(i,V)}}):null,T("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(i.selected===!0?m.value:M.value)},[b?b(W):[L(u),T("div",u[e.labelKey])]])]),w===!0?e.noTransition===!0?T("div",{class:"q-tree__node-collapsible"+M.value,key:`${f}__q`},[F,T("div",{class:"q-tree__children"+(i.disabled===!0?" q-tree__node--disabled":"")},i.expanded?g:null)]):T(at,{duration:e.duration,onShow:X,onHide:Q},()=>et(T("div",{class:"q-tree__node-collapsible"+M.value,key:`${f}__q`},[F,T("div",{class:"q-tree__children"+(i.disabled===!0?" q-tree__node--disabled":"")},g)]),[[tt,i.expanded]])):F])}function ve(u){const f=$[u];f&&f.focus()}function ye(u,f,i,b){b!==!0&&f.selectable!==!1&&ve(f.key),y.value&&f.selectable?e.noSelectionUnset===!1?n("update:selected",f.key!==e.selected?f.key:null):f.key!==e.selected&&n("update:selected",f.key===void 0?null:f.key):ne(u,f,i,b),typeof u.handler=="function"&&u.handler(u)}function ne(u,f,i,b){i!==void 0&&te(i),b!==!0&&f.selectable!==!1&&ve(f.key),N(f.key,!f.expanded,u,f)}function ze(u,f){if(u.indeterminate===!0&&(f=u.indeterminateNextState),u.strictTicking)C([u.key],f);else if(u.leafTicking){const i=[],b=g=>{g.isParent?(f!==!0&&g.noTick!==!0&&g.tickable===!0&&i.push(g.key),g.leafTicking===!0&&g.children.forEach(b)):g.noTick!==!0&&g.tickable===!0&&(g.leafFilteredTicking!==!0||g.matchesFilter===!0)&&i.push(g.key)};b(u),C(i,f)}}return e.defaultExpandAll===!0&&z(),Object.assign(r,{getNodeByKey:K,getTickedNodes:j,getExpandedNodes:v,isExpanded:I,collapseAll:O,expandAll:z,setExpanded:N,isTicked:S,setTicked:C}),()=>{const u=B(e.nodes);return T("div",{class:o.value},u.length===0?e.filter?e.noResultsLabel||l.lang.tree.noResults:e.noNodesLabel||l.lang.tree.noNodes:u)}}});export{Vt as Q,Et as a,Qt as b,Wt as c,E as d,at as e,Kt as f,zt as g,Nt as h,Ft as u};
