import{f as U,a1 as u,a2 as p,a4 as S,a7 as i,a8 as t,aw as e,b8 as $,ay as m,aa as H,a9 as c,aG as x,b3 as f,b9 as O,a_ as Y,aH as G}from"./index-52896586.js";import{Q as I,a as K}from"./QToolbar-5c4eb316.js";import{Q as M}from"./QForm-81ae9ad4.js";import{Q as R}from"./GoalStore-74e108f3.js";import{u as A,_ as D}from"./NumberInput-21cde291.js";import{d as F}from"./date-7894991d.js";import{u as j}from"./TaskStore-90304fee.js";import{u as z,_ as V}from"./DateInput-42ee6451.js";import{_ as E}from"./GoalSelect-abe5b0c5.js";import{_ as J}from"./DurationInput-703e9dbb.js";import"./format-ff5bcb16.js";import"./QItem-4de8b7a5.js";import"./QItemLabel-f95f7916.js";import"./QMenu-f314d073.js";const L={class:"q-pa-md"},W={class:"row q-col-gutter-lg"},pe={__name:"TaskView",setup(X){const P=S(),b=A(),g=j(),s=parseInt(P.params.id),{item:l,original:q,path:w,persist:k,remove:_,save:v,back:y}=z(s,g,{name:"",goal:null,planned:null,recurring_until:null,target:1,performance:0,planned_total_time:null,done:null,description:"",performance_history:[]}),C=U(()=>!l.value.name||k.value||Boolean(s&&!g.isChanged(q,{...l.value}))),d=U(()=>{const n=l.value.performance_history;if(!n||!n.length)return null;const o=r=>F.formatDate(r.updated,"DD.MM.YYYY HH:mm")+" to "+r.value;let a=o(n[0]);if(n.length===1)return a;for(let r=1;r<n.length;r++)a+=", "+o(n[r]);return a}),Q={type:"radio",model:"this",items:[{label:"This task",value:"this"},{label:"All tasks",value:"all"}]};function T(){w.value="recurring/"+l.value.group_id+"/"}function B(){l.value.group_id?b.dialog({title:"Delete recurring task",cancel:!0,ok:"Delete",options:Q}).onOk(n=>{n==="all"&&T(),_()}):_()}function N(){l.value.group_id?b.dialog({title:"Save recurring task",cancel:!0,ok:"Save",options:Q}).onOk(n=>{n==="all"&&T(),v()}):v()}return(n,o)=>(i(),u(R,{padding:""},{default:p(()=>[t(M,{onSubmit:G(N,["prevent"])},{default:p(()=>[t(I,null,{default:p(()=>[e(l).group_id?(i(),u($,{key:0,icon:"event_repeat"})):m("",!0),t(K,null,{default:p(()=>[H("Task")]),_:1}),e(s)?(i(),u(c,{key:1,type:"button",flat:"",round:"",icon:"delete",disable:e(k),onClick:B},null,8,["disable"])):m("",!0),t(c,{type:"submit",flat:"",round:"",icon:"save",disable:e(C)},null,8,["disable"]),t(c,{type:"button",flat:"",round:"",icon:"clear",onClick:e(y)},null,8,["onClick"])]),_:1}),x("div",L,[t(f,{modelValue:e(l).name,"onUpdate:modelValue":o[0]||(o[0]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(s),rules:[a=>!!a||"Field is required"],onKeyup:O(e(y),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),x("div",W,[t(E,{modelValue:e(l).goal,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(V,{modelValue:e(l).planned,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).planned=a),label:"Planned",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(s)?m("",!0):(i(),u(V,{key:0,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-sm-6"},null,8,["modelValue"])),t(D,{modelValue:e(l).target,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).target=a),label:"Target",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(D,{modelValue:e(l).performance,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(J,{modelValue:e(l).planned_total_time,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).planned_total_time=a),label:"Planned total time",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(s)?(i(),u(V,{key:1,modelValue:e(l).done,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).done=a),label:"Done",class:"col-12 col-sm-6"},null,8,["modelValue"])):m("",!0)]),t(f,{modelValue:e(l).description,"onUpdate:modelValue":o[8]||(o[8]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(d)?(i(),u(f,{key:0,modelValue:e(d),"onUpdate:modelValue":o[9]||(o[9]=a=>Y(d)?d.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):m("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{pe as default};
