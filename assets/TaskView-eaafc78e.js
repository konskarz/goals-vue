import{f as T,a1 as r,a2 as p,a4 as K,a7 as i,a8 as t,aF as e,b2 as O,aK as d,aa as Y,a9 as f,aE as U,a_ as V,b3 as $,aG as F,aL as G}from"./index-32702dd5.js";import{Q as H,a as I}from"./QToolbar-1b544c2a.js";import{Q as M}from"./QForm-182b5dc2.js";import{Q as R}from"./GoalStore-8df59a85.js";import{u as A,_ as x}from"./NumberInput-2ae5f2f5.js";import{u as E,d as L}from"./TaskStore-101d8004.js";import{u as j,_ as z,a as c}from"./DateInput-83f1776c.js";import"./format-ff5bcb16.js";import"./QField-8cd640fb.js";import"./QItem-18ac8077.js";import"./QMenu-8ad2c9ae.js";const J={class:"q-pa-md"},W={class:"row q-col-gutter-lg"},ie={__name:"TaskView",setup(X){const D=K(),b=A(),q=E(),n=parseInt(D.params.id),{item:l,original:S,path:w,persist:g,changed:B,remove:k,save:v,back:y}=j(n,q,{name:"",goal:null,starts:null,ends:null,recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),C=T(()=>!l.value.name||g.value||Boolean(n&&!B(S,{...l.value}))),m=T(()=>{const s=l.value.performance_history;if(!s||!s.length)return null;const o=u=>L.formatDate(u.updated,"DD.MM.YYYY HH:mm")+" to "+u.value;let a=o(s[0]);if(s.length===1)return a;for(let u=1;u<s.length;u++)a+=", "+o(s[u]);return a}),_={type:"radio",model:"this",items:[{label:"This task",value:"this"},{label:"All tasks",value:"all"}]};function Q(){w.value="recurring/"+l.value.group_id+"/"}function N(){l.value.group_id?b.dialog({title:"Delete recurring task",cancel:!0,ok:"Delete",options:_}).onOk(s=>{s==="all"&&Q(),k()}):k()}function P(){l.value.group_id?b.dialog({title:"Save recurring task",cancel:!0,ok:"Save",options:_}).onOk(s=>{s==="all"&&Q(),v()}):v()}return(s,o)=>(i(),r(R,{padding:""},{default:p(()=>[t(M,{onSubmit:G(P,["prevent"])},{default:p(()=>[t(H,null,{default:p(()=>[e(l).group_id?(i(),r(O,{key:0,icon:"event_repeat"})):d("",!0),t(I,null,{default:p(()=>[Y("Task")]),_:1}),e(n)?(i(),r(f,{key:1,type:"button",flat:"",round:"",icon:"delete",disable:e(g),onClick:N},null,8,["disable"])):d("",!0),t(f,{type:"submit",flat:"",round:"",icon:"save",disable:e(C)},null,8,["disable"]),t(f,{type:"button",flat:"",round:"",icon:"clear",onClick:e(y)},null,8,["onClick"])]),_:1}),U("div",J,[t(V,{modelValue:e(l).name,"onUpdate:modelValue":o[0]||(o[0]=a=>e(l).name=a),label:"Name","stack-label":"",autofocus:!e(n),rules:[a=>!!a||"Field is required"],onKeyup:$(e(y),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),U("div",W,[t(z,{modelValue:e(l).goal,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).goal=a),label:"Goal","stack-label":"",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(c,{modelValue:e(l).starts,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).starts=a),label:"Starts",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(c,{modelValue:e(l).ends,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).ends=a),label:"Ends",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(n)?d("",!0):(i(),r(c,{key:0,modelValue:e(l).recurring_until,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).recurring_until=a),label:"Recurring until",class:"col-12 col-sm-6"},null,8,["modelValue"])),t(x,{modelValue:e(l).target,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).target=a),label:"Target",class:"col-12 col-sm-6"},null,8,["modelValue"]),t(x,{modelValue:e(l).performance,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).performance=a),label:"Performance",class:"col-12 col-sm-6"},null,8,["modelValue"]),e(n)?(i(),r(c,{key:1,modelValue:e(l).done,"onUpdate:modelValue":o[7]||(o[7]=a=>e(l).done=a),label:"Done",class:"col-12 col-sm-6"},null,8,["modelValue"])):d("",!0)]),t(V,{modelValue:e(l).description,"onUpdate:modelValue":o[8]||(o[8]=a=>e(l).description=a),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),e(m)?(i(),r(V,{key:0,modelValue:e(m),"onUpdate:modelValue":o[9]||(o[9]=a=>F(m)?m.value=a:null),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):d("",!0)])]),_:1},8,["onSubmit"])]),_:1}))}};export{ie as default};
