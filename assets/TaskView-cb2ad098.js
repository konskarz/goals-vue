import{b as T}from"./use-dark-805ac600.js";import{c as D,j as k,h as C,$ as M,Q as t,R as u,S as V,T as s,U as b,r as N,w as P,V as q,Z as l,a0 as f,ag as $,a7 as B}from"./index-fa80b5dc.js";import{u as Y,b as F,c as H}from"./QTree-44413777.js";import{Q as g,a as K}from"./QForm-590063c3.js";import{a as j,M as G,d as R}from"./MainPage-97892c33.js";import{u as E,_ as O,a as x}from"./DateInput-d7d5743a.js";import"./use-form-a3f470e7.js";import"./QSlideTransition-fab7d83a.js";import"./uid-6a237b22.js";import"./format-8c778330.js";import"./use-timeout-34e9cac5.js";import"./use-model-toggle-73a74994.js";const Z=D({name:"QToggle",props:{...Y,icon:String,iconColor:String},emits:F,setup(d){function v(n,e){const i=k(()=>(n.value===!0?d.checkedIcon:e.value===!0?d.indeterminateIcon:d.uncheckedIcon)||d.icon),r=k(()=>n.value===!0?d.iconColor:null);return()=>[C("div",{class:"q-toggle__track"}),C("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},i.value!==void 0?[C(M,{name:i.value,color:r.value})]:void 0)]}return H("toggle",v)}}),Q={__name:"NumberInput",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(d,{emit:v}){const n=d,e=k({get(){return n.modelValue},set(i){i>=0&&v("update:modelValue",i)}});return(i,r)=>(t(),u(g,{modelValue:e.value,"onUpdate:modelValue":r[2]||(r[2]=p=>e.value=p),modelModifiers:{number:!0},type:"number",min:"0","stack-label":""},{append:V(()=>[s(b,{round:"",label:"-1",onClick:r[0]||(r[0]=p=>e.value--)}),s(b,{round:"",label:"+1",onClick:r[1]||(r[1]=p=>e.value++)})]),_:1},8,["modelValue"]))}},te={__name:"TaskView",props:{id:{type:String,required:!0}},setup(d){const n=parseInt(d.id),{item:e,original:i,path:r,persist:p,changed:S,remove:w,save:U,back:I}=E(n,j(),{name:"",goal:null,planned:new Date().toISOString(),recurring_until:null,target:1,performance:0,done:null,description:"",performance_history:[]}),m=N(!1),_=k(()=>!e.value.name||!e.value.planned||p.value||!!(n&&!S(i,{...e.value}))),y=k(()=>{const c=e.value.performance_history;return!c||!c.length?null:c.map(a=>R.formatDate(a.updated,"DD.MM.YYYY HH:mm")+" to "+a.value).join(", ")});return P(m,c=>{r.value=c?"recurring/"+e.value.group_id+"/":n+"/"}),(c,a)=>(t(),u(G,null,{toolbar:V(()=>[m.value?(t(),u(T,{key:1},{default:V(()=>[q("Group")]),_:1})):(t(),u(T,{key:0},{default:V(()=>[q("Task")]),_:1})),l(e).group_id?(t(),u(Z,{key:2,modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=o=>m.value=o),"checked-icon":"done_all","unchecked-icon":"done"},null,8,["modelValue"])):f("",!0),l(n)?(t(),u(b,{key:3,flat:"",round:"",icon:"delete",disable:l(p),onClick:l(w)},null,8,["disable","onClick"])):f("",!0),s(b,{flat:"",round:"",icon:"save",disable:_.value,onClick:l(U)},null,8,["disable","onClick"]),s(b,{flat:"",round:"",icon:"clear",onClick:l(I)},null,8,["onClick"])]),default:V(()=>[s(K,{class:"q-pt-sm q-px-lg",onSubmit:B(l(U),["prevent"])},{default:V(()=>[s(g,{modelValue:l(e).name,"onUpdate:modelValue":a[1]||(a[1]=o=>l(e).name=o),label:"Name","stack-label":"",autofocus:!l(n),rules:[o=>!!o||"Field is required"],onKeyup:$(l(I),["esc"])},null,8,["modelValue","autofocus","rules","onKeyup"]),s(O,{modelValue:l(e).goal,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).goal=o),label:"Goal","stack-label":""},null,8,["modelValue"]),m.value?f("",!0):(t(),u(x,{key:0,modelValue:l(e).planned,"onUpdate:modelValue":a[3]||(a[3]=o=>l(e).planned=o),label:"Planned",rules:[o=>!!o||"Field is required"]},null,8,["modelValue","rules"])),l(n)?(t(),u(x,{key:1,modelValue:l(e).done,"onUpdate:modelValue":a[4]||(a[4]=o=>l(e).done=o),label:"Done"},null,8,["modelValue"])):(t(),u(x,{key:2,modelValue:l(e).recurring_until,"onUpdate:modelValue":a[5]||(a[5]=o=>l(e).recurring_until=o),label:"Recurring until"},null,8,["modelValue"])),s(Q,{modelValue:l(e).target,"onUpdate:modelValue":a[6]||(a[6]=o=>l(e).target=o),label:"Target"},null,8,["modelValue"]),m.value?f("",!0):(t(),u(Q,{key:3,modelValue:l(e).performance,"onUpdate:modelValue":a[7]||(a[7]=o=>l(e).performance=o),label:"Performance"},null,8,["modelValue"])),s(g,{modelValue:l(e).description,"onUpdate:modelValue":a[8]||(a[8]=o=>l(e).description=o),type:"textarea",label:"Description","stack-label":"",class:"q-pt-md"},null,8,["modelValue"]),y.value&&!m.value?(t(),u(g,{key:4,modelValue:y.value,"onUpdate:modelValue":a[9]||(a[9]=o=>y.value=o),type:"textarea",label:"Performance updates","stack-label":"",readonly:"",class:"q-pt-md"},null,8,["modelValue"])):f("",!0)]),_:1},8,["onSubmit"])]),_:1}))}};export{te as default};
