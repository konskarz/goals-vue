import{c as he,j as Ve,h as Y,T as Re,r as j,ch as Ze,ci as Te,cj as Ye,ck as je,cl as we,w as ue,a as w,g as _e,c1 as Be,v as Qe,b as We,c0 as Pe,bm as U,b_ as te,Q as se,aT as Ue,aO as Xe,cm as Je,cn as Ge,bM as et,bE as tt,cb as Me}from"./index-7e23eb14.js";import{a as Ie,u as Ce}from"./QToolbar-42614659.js";import{u as nt,a as rt}from"./use-form-05eaf2b9.js";const at=he({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:t,emit:n}){let r=!1,l,a,c=null,s=null,o,S;function d(){l&&l(),l=null,r=!1,c!==null&&(clearTimeout(c),c=null),s!==null&&(clearTimeout(s),s=null),a!==void 0&&a.removeEventListener("transitionend",o),o=null}function m(y,I,k){I!==void 0&&(y.style.height=`${I}px`),y.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,r=!0,l=k}function $(y,I){y.style.overflowY=null,y.style.height=null,y.style.transition=null,d(),I!==S&&n(I)}function x(y,I){let k=0;a=y,r===!0?(d(),k=y.offsetHeight===y.scrollHeight?0:void 0):(S="hide",y.style.overflowY="hidden"),m(y,k,I),c=setTimeout(()=>{c=null,y.style.height=`${y.scrollHeight}px`,o=K=>{s=null,(Object(K)!==K||K.target===y)&&$(y,"show")},y.addEventListener("transitionend",o),s=setTimeout(o,e.duration*1.1)},100)}function M(y,I){let k;a=y,r===!0?d():(S="show",y.style.overflowY="hidden",k=y.scrollHeight),m(y,k,I),c=setTimeout(()=>{c=null,y.style.height=0,o=K=>{s=null,(Object(K)!==K||K.target===y)&&$(y,"hide")},y.addEventListener("transitionend",o),s=setTimeout(o,e.duration*1.1)},100)}return Ve(()=>{r===!0&&d()}),()=>Y(Re,{css:!1,appear:e.appear,onEnter:x,onLeave:M},t.default)}});function lt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Qt(e,t,n){return n<=t?t:Math.min(n,Math.max(t,e))}function H(e,t=2,n="0"){if(e==null)return e;const r=""+e;return r.length>=t?r:new Array(t-r.length+1).join(n)+r}function $e(e){const{request:t,get:n}=Ze(),r=j(JSON.parse(localStorage.getItem(e)));function l(){n(e).then(S=>{r.value=S,localStorage.setItem(e,JSON.stringify(S))})}function a(S){return r.value.find(d=>d.id===S)}function c(S){return t({method:"post",url:e,data:S})}function s(S,d){return t({method:"patch",url:e+S,data:d})}function o(S){return t({method:"delete",url:e+S})}return l(),{data:r,refetch:l,getItem:a,createItem:c,updateItem:s,deleteItem:o}}const G=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function it(e){return st(e)===0}function ut(e,t){return t<=6?31:t<=11||it(e)?30:29}function st(e){const t=G.length;let n=G[0],r,l,a,c,s;if(e<n||e>=G[t-1])throw new Error("Invalid Jalaali year "+e);for(s=1;s<t&&(r=G[s],l=r-n,!(e<r));s+=1)n=r;return c=e-n,l-c<6&&(c=c-l+ot(l+4,33)*33),a=ke(ke(c+1,33)-1,4),a===-1&&(a=4),a}function ot(e,t){return~~(e/t)}function ke(e,t){return e-~~(e/t)*t}const qe=864e5,ct=36e5,oe=6e4,Oe="YYYY-MM-DDTHH:mm:ss.SSSZ",dt=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,ft=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,le={};function ht(e,t){const n="("+t.days.join("|")+")",r=e+n;if(le[r]!==void 0)return le[r];const l="("+t.daysShort.join("|")+")",a="("+t.months.join("|")+")",c="("+t.monthsShort.join("|")+")",s={};let o=0;const S=e.replace(ft,m=>{switch(o++,m){case"YY":return s.YY=o,"(-?\\d{1,2})";case"YYYY":return s.YYYY=o,"(-?\\d{1,4})";case"M":return s.M=o,"(\\d{1,2})";case"MM":return s.M=o,"(\\d{2})";case"MMM":return s.MMM=o,c;case"MMMM":return s.MMMM=o,a;case"D":return s.D=o,"(\\d{1,2})";case"Do":return s.D=o++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return s.D=o,"(\\d{2})";case"H":return s.H=o,"(\\d{1,2})";case"HH":return s.H=o,"(\\d{2})";case"h":return s.h=o,"(\\d{1,2})";case"hh":return s.h=o,"(\\d{2})";case"m":return s.m=o,"(\\d{1,2})";case"mm":return s.m=o,"(\\d{2})";case"s":return s.s=o,"(\\d{1,2})";case"ss":return s.s=o,"(\\d{2})";case"S":return s.S=o,"(\\d{1})";case"SS":return s.S=o,"(\\d{2})";case"SSS":return s.S=o,"(\\d{3})";case"A":return s.A=o,"(AM|PM)";case"a":return s.a=o,"(am|pm)";case"aa":return s.aa=o,"(a\\.m\\.|p\\.m\\.)";case"ddd":return l;case"dddd":return n;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return s.Z=o,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return s.ZZ=o,"(Z|[+-]\\d{2}\\d{2})";case"X":return s.X=o,"(-?\\d+)";case"x":return s.x=o,"(-?\\d{4,})";default:return o--,m[0]==="["&&(m=m.substring(1,m.length-1)),m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),d={map:s,regex:new RegExp("^"+S)};return le[r]=d,d}function Ee(e,t){return e!==void 0?e:t!==void 0?t.date:je.date}function Se(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),l=Math.floor(r/60),a=r%60;return n+H(l)+t+H(a)}function gt(e,t,n){let r=e.getFullYear(),l=e.getMonth();const a=e.getDate();return t.year!==void 0&&(r+=n*t.year,delete t.year),t.month!==void 0&&(l+=n*t.month,delete t.month),e.setDate(1),e.setMonth(2),e.setFullYear(r),e.setMonth(l),e.setDate(Math.min(a,ve(e))),t.date!==void 0&&(e.setDate(e.getDate()+n*t.date),delete t.date),e}function vt(e,t,n){const r=t.year!==void 0?t.year:e[`get${n}FullYear`](),l=t.month!==void 0?t.month-1:e[`get${n}Month`](),a=new Date(r,l+1,0).getDate(),c=Math.min(a,t.date!==void 0?t.date:e[`get${n}Date`]());return e[`set${n}Date`](1),e[`set${n}Month`](2),e[`set${n}FullYear`](r),e[`set${n}Month`](l),e[`set${n}Date`](c),delete t.year,delete t.month,delete t.date,e}function ge(e,t,n){const r=Fe(t),l=new Date(e),a=r.year!==void 0||r.month!==void 0||r.date!==void 0?gt(l,r,n):l;for(const c in r){const s=lt(c);a[`set${s}`](a[`get${s}`]()+n*r[c])}return a}function Fe(e){const t={...e};return e.years!==void 0&&(t.year=e.years,delete t.years),e.months!==void 0&&(t.month=e.months,delete t.months),e.days!==void 0&&(t.date=e.days,delete t.days),e.day!==void 0&&(t.date=e.day,delete t.day),e.hour!==void 0&&(t.hours=e.hour,delete t.hour),e.minute!==void 0&&(t.minutes=e.minute,delete t.minute),e.second!==void 0&&(t.seconds=e.second,delete t.second),e.millisecond!==void 0&&(t.milliseconds=e.millisecond,delete t.millisecond),t}function He(e,t,n){const r=Fe(t),l=n===!0?"UTC":"",a=new Date(e),c=r.year!==void 0||r.month!==void 0||r.date!==void 0?vt(a,r,l):a;for(const s in r){const o=s.charAt(0).toUpperCase()+s.slice(1);c[`set${l}${o}`](r[s])}return c}function yt(e,t,n){const r=mt(e,t,n),l=new Date(r.year,r.month===null?null:r.month-1,r.day===null?1:r.day,r.hour,r.minute,r.second,r.millisecond),a=l.getTimezoneOffset();return r.timezoneOffset===null||r.timezoneOffset===a?l:ge(l,{minutes:r.timezoneOffset-a},1)}function mt(e,t,n,r,l){const a={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(l!==void 0&&Object.assign(a,l),e==null||e===""||typeof e!="string")return a;t===void 0&&(t=Oe);const c=Ee(n,Te.props),s=c.months,o=c.monthsShort,{regex:S,map:d}=ht(t,c),m=e.match(S);if(m===null)return a;let $="";if(d.X!==void 0||d.x!==void 0){const x=parseInt(m[d.X!==void 0?d.X:d.x],10);if(isNaN(x)===!0||x<0)return a;const M=new Date(x*(d.X!==void 0?1e3:1));a.year=M.getFullYear(),a.month=M.getMonth()+1,a.day=M.getDate(),a.hour=M.getHours(),a.minute=M.getMinutes(),a.second=M.getSeconds(),a.millisecond=M.getMilliseconds()}else{if(d.YYYY!==void 0)a.year=parseInt(m[d.YYYY],10);else if(d.YY!==void 0){const x=parseInt(m[d.YY],10);a.year=x<0?x:2e3+x}if(d.M!==void 0){if(a.month=parseInt(m[d.M],10),a.month<1||a.month>12)return a}else d.MMM!==void 0?a.month=o.indexOf(m[d.MMM])+1:d.MMMM!==void 0&&(a.month=s.indexOf(m[d.MMMM])+1);if(d.D!==void 0){if(a.day=parseInt(m[d.D],10),a.year===null||a.month===null||a.day<1)return a;const x=r!=="persian"?new Date(a.year,a.month,0).getDate():ut(a.year,a.month);if(a.day>x)return a}d.H!==void 0?a.hour=parseInt(m[d.H],10)%24:d.h!==void 0&&(a.hour=parseInt(m[d.h],10)%12,(d.A&&m[d.A]==="PM"||d.a&&m[d.a]==="pm"||d.aa&&m[d.aa]==="p.m.")&&(a.hour+=12),a.hour=a.hour%24),d.m!==void 0&&(a.minute=parseInt(m[d.m],10)%60),d.s!==void 0&&(a.second=parseInt(m[d.s],10)%60),d.S!==void 0&&(a.millisecond=parseInt(m[d.S],10)*10**(3-m[d.S].length)),(d.Z!==void 0||d.ZZ!==void 0)&&($=d.Z!==void 0?m[d.Z].replace(":",""):m[d.ZZ],a.timezoneOffset=($[0]==="+"?-1:1)*(60*$.slice(1,3)+1*$.slice(3,5)))}return a.dateHash=H(a.year,6)+"/"+H(a.month)+"/"+H(a.day),a.timeHash=H(a.hour)+":"+H(a.minute)+":"+H(a.second)+$,a}function Dt(e){return typeof e=="number"?!0:isNaN(Date.parse(e))===!1}function bt(e,t){return He(new Date,e,t)}function Mt(e){const t=new Date(e).getDay();return t===0?7:t}function ce(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);const n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);const r=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-r);const l=(t-n)/(qe*7);return 1+Math.floor(l)}function kt(e){return e.getFullYear()*1e4+e.getMonth()*100+e.getDate()}function ie(e,t){const n=new Date(e);return t===!0?kt(n):n.getTime()}function St(e,t,n,r={}){const l=ie(t,r.onlyDate),a=ie(n,r.onlyDate),c=ie(e,r.onlyDate);return(c>l||r.inclusiveFrom===!0&&c===l)&&(c<a||r.inclusiveTo===!0&&c===a)}function xt(e,t){return ge(e,t,1)}function pt(e,t){return ge(e,t,-1)}function Z(e,t,n){const r=new Date(e),l=`set${n===!0?"UTC":""}`;switch(t){case"year":case"years":r[`${l}Month`](0);case"month":case"months":r[`${l}Date`](1);case"day":case"days":case"date":r[`${l}Hours`](0);case"hour":case"hours":r[`${l}Minutes`](0);case"minute":case"minutes":r[`${l}Seconds`](0);case"second":case"seconds":r[`${l}Milliseconds`](0)}return r}function Tt(e,t,n){const r=new Date(e),l=`set${n===!0?"UTC":""}`;switch(t){case"year":case"years":r[`${l}Month`](11);case"month":case"months":r[`${l}Date`](ve(r));case"day":case"days":case"date":r[`${l}Hours`](23);case"hour":case"hours":r[`${l}Minutes`](59);case"minute":case"minutes":r[`${l}Seconds`](59);case"second":case"seconds":r[`${l}Milliseconds`](999)}return r}function Yt(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(n=>{t=Math.max(t,new Date(n))}),t}function wt(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach(n=>{t=Math.min(t,new Date(n))}),t}function ee(e,t,n){return(e.getTime()-e.getTimezoneOffset()*oe-(t.getTime()-t.getTimezoneOffset()*oe))/n}function Ae(e,t,n="days"){const r=new Date(e),l=new Date(t);switch(n){case"years":case"year":return r.getFullYear()-l.getFullYear();case"months":case"month":return(r.getFullYear()-l.getFullYear())*12+r.getMonth()-l.getMonth();case"days":case"day":case"date":return ee(Z(r,"day"),Z(l,"day"),qe);case"hours":case"hour":return ee(Z(r,"hour"),Z(l,"hour"),ct);case"minutes":case"minute":return ee(Z(r,"minute"),Z(l,"minute"),oe);case"seconds":case"second":return ee(Z(r,"second"),Z(l,"second"),1e3)}}function de(e){return Ae(e,Z(e,"year"),"days")+1}function _t(e){return Ye(e)===!0?"date":typeof e=="number"?"number":"string"}function It(e,t,n){const r=new Date(e);if(t){const l=new Date(t);if(r<l)return l}if(n){const l=new Date(n);if(r>l)return l}return r}function Ct(e,t,n){const r=new Date(e),l=new Date(t);if(n===void 0)return r.getTime()===l.getTime();switch(n){case"second":case"seconds":if(r.getSeconds()!==l.getSeconds())return!1;case"minute":case"minutes":if(r.getMinutes()!==l.getMinutes())return!1;case"hour":case"hours":if(r.getHours()!==l.getHours())return!1;case"day":case"days":case"date":if(r.getDate()!==l.getDate())return!1;case"month":case"months":if(r.getMonth()!==l.getMonth())return!1;case"year":case"years":if(r.getFullYear()!==l.getFullYear())return!1;break;default:throw new Error(`date isSameDate unknown unit ${n}`)}return!0}function ve(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function xe(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const pe={YY(e,t,n){const r=this.YYYY(e,t,n)%100;return r>=0?H(r):"-"+H(Math.abs(r))},YYYY(e,t,n){return n??e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return H(e.getMonth()+1)},MMM(e,t){return t.monthsShort[e.getMonth()]},MMMM(e,t){return t.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return xe(this.Q(e))},D(e){return e.getDate()},Do(e){return xe(e.getDate())},DD(e){return H(e.getDate())},DDD(e){return de(e)},DDDD(e){return H(de(e),3)},d(e){return e.getDay()},dd(e,t){return this.dddd(e,t).slice(0,2)},ddd(e,t){return t.daysShort[e.getDay()]},dddd(e,t){return t.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return ce(e)},ww(e){return H(ce(e))},H(e){return e.getHours()},HH(e){return H(e.getHours())},h(e){const t=e.getHours();return t===0?12:t>12?t%12:t},hh(e){return H(this.h(e))},m(e){return e.getMinutes()},mm(e){return H(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return H(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return H(Math.floor(e.getMilliseconds()/10))},SSS(e){return H(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,t,n,r){const l=r??e.getTimezoneOffset();return Se(l,":")},ZZ(e,t,n,r){const l=r??e.getTimezoneOffset();return Se(l)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function $t(e,t,n,r,l){if(e!==0&&!e||e===1/0||e===-1/0)return;const a=new Date(e);if(isNaN(a))return;t===void 0&&(t=Oe);const c=Ee(n,Te.props);return t.replace(dt,(s,o)=>s in pe?pe[s](a,c,r,l):o===void 0?s:o.split("\\]").join("]"))}function qt(e){return Ye(e)===!0?new Date(e.getTime()):e}const E={isValid:Dt,extractDate:yt,buildDate:bt,getDayOfWeek:Mt,getWeekOfYear:ce,isBetweenDates:St,addToDate:xt,subtractFromDate:pt,adjustDate:He,startOfDate:Z,endOfDate:Tt,getMaxDate:Yt,getMinDate:wt,getDateDiff:Ae,getDayOfYear:de,inferDateFormat:_t,getDateBetween:It,isSameDate:Ct,daysInMonth:ve,formatDate:$t,clone:qt};function Ot(){const e=v=>E.startOfDate(v,"day"),t=v=>E.subtractFromDate(v,{days:E.getDayOfWeek(v)-1}),n=v=>E.subtractFromDate(v,{days:7}),r=v=>E.subtractFromDate(v,{days:1}),l=v=>E.addToDate(v,{days:7}),a=v=>E.formatDate(v,"YYYY-MM-DD"),c=e(new Date),s=t(c),o=E.addToDate(s,{days:6}),S=E.subtractFromDate(c,{months:6}),d=v=>e(v)<s,m=v=>e(v)>o,$=v=>E.isBetweenDates(e(v),S,c),x=v=>e(v)<=c,M=(v,C)=>{const q=[];return E.isSameDate(v,C,"year")?(q.push(E.formatDate(v,E.isSameDate(v,C,"month")?"D–":"D MMM – ")),q.push(E.formatDate(C,"D MMM"))):(q.push(E.formatDate(v,"D MMM YYYY – ")),q.push(E.formatDate(C,"D MMM YYYY"))),q.join("")},y=(v,C)=>({title:M(v,C),current:E.isSameDate(v,s,"day"),start:!E.isSameDate(v,n(v),"month"),month:E.formatDate(v,"MMMM YYYY"),tasks:[]});function I(v){const C={},q=l(t(e(v[v.length-1].planned)));let z,N=t(e(v[0].planned)),h=r(N);for(;N<=q;)z=l(h),C[a(N)]=y(N,z),N=l(N),h=z;return v.forEach(T=>{C[a(t(T.planned))].tasks.push(T)}),C}function k(v){return v.reduce((C,q)=>{const z=t(e(q.planned)),N=l(r(z)),h=a(z);return C[h]||(C[h]=y(z,N)),C[h].tasks.push(q),C},{})}function K(v){const C=(h,T,O)=>{for(;T<=O;)h.push({x:a(T),y:null}),T=l(T);return h},q=h=>h.done?100:h.target>1?Math.round(h.performance/h.target*100):0,z=t(S),N=t(c);return v.reduce((h,T)=>{h[T.name]||(h[T.name]=C([],z,N));const O=a(t(T.planned));return h[T.name].find(D=>D.x===O).y=q(T),h},{})}function B(v,C){const q=E.getDayOfWeek(v)-1;return E.addToDate(C,{days:q})}return{beforeThisWeek:d,afterThisWeek:m,seriesRange:$,beforeThisDay:x,buildCalendar:I,buildAgenda:k,buildSeries:K,changeWeek:B}}const fe=(e,t=null)=>e.filter(n=>n.parent===t).map(n=>({...n,children:fe(e,n.id)})),Et=we("GoalStore",()=>{const{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a}=$e("/goals/"),c=Ft(),s=j([]),o=j([]);ue(e,()=>{if(o.value.length){const x=o.value,M=x.length;for(let y=0;y<M;y++)if(!n(x[y])){x.splice(y,1);break}}});const S=w(()=>!e.value||!c.data?null:e.value.map(x=>({...x,...c.getReport($(x.id))}))),d=w(()=>e.value?fe(e.value):null),m=w(()=>S.value?fe(S.value):null);function $(x){if(!x)return e.value.map(I=>I.id);const M=[x],y=I=>e.value.filter(k=>k.parent===I).forEach(k=>{M.push(k.id),y(k.id)});return y(x),M}return{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a,treeTicked:o,treeExpanded:s,tree:d,treeReport:m,getBranch:$}}),Ft=we("TaskStore",()=>{const{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a}=$e("/tasks/"),{beforeThisWeek:c,afterThisWeek:s,seriesRange:o,beforeThisDay:S,buildCalendar:d,buildAgenda:m,buildSeries:$,changeWeek:x}=Ot(),M=Et(),y=w(()=>!e.value||!M.data?null:e.value.map(h=>({...h,goalName:h.goal?M.getItem(h.goal).name:null}))),I=j({show:!1,pastDone:!1,pastRecurring:!1,futureRecurring:!1,emptyWeeks:!1}),k=w(()=>e.value?e.value.filter(h=>!(!h.planned||c(h.planned)&&(!I.value.pastDone&&h.done||!I.value.pastRecurring&&h.group_id)||s(h.planned)&&!I.value.futureRecurring&&h.group_id||M.treeTicked.length&&!M.treeTicked.includes(h.goal))).sort((h,T)=>Date.parse(h.planned)-Date.parse(T.planned)):null),K=w(()=>k.value&&k.value.length?I.value.emptyWeeks?d(k.value):m(k.value):null),B=w(()=>e.value?q():null),v=w(()=>{if(!k.value)return null;const h=C(k.value);return h.target>0||h.rperformance!==null?h:null});function C(h){const T=h.filter(L=>!L.group_id),O=T.filter(L=>L.done),D=h.filter(L=>L.group_id&&L.planned&&S(L.planned)),R=L=>L.reduce((X,Q)=>Q.done?X+1:Q.target>1?X+Q.performance/Q.target:X,0);return{target:T.length,performance:O.length,rtarget:D.length,rperformance:D.length?R(D):null,series:D.length?q([...new Set(D.map(L=>L.group_id))]):null}}function q(h){const T=e.value.filter(O=>!O.group_id||!O.planned||h&&h.length&&!h.includes(O.group_id)?!1:o(O.planned)).sort((O,D)=>Date.parse(O.planned)-Date.parse(D.planned));return T.length?$(T):null}function z(h){return C(e.value.filter(T=>h.includes(T.goal)))}function N(h,T){const O={planned:x(h.planned,T).toISOString()};l(h.id+"/",O).then(()=>t())}return{data:e,refetch:t,getItem:n,createItem:r,updateItem:l,deleteItem:a,relative:y,filter:I,filtered:k,calendar:K,series:B,report:v,getSeries:q,getReport:z,moveItem:N}});function Ht(e,t){const n=j(null),r=w(()=>e.disable===!0?null:Y("span",{ref:n,class:"no-outline",tabindex:-1}));function l(a){const c=t.value;a!==void 0&&a.type.indexOf("key")===0?c!==null&&document.activeElement!==c&&c.contains(document.activeElement)===!0&&c.focus():n.value!==null&&(a===void 0||c!==null&&c.contains(a.target)===!0)&&n.value.focus()}return{refocusTargetEl:r,refocusTarget:l}}const At={xs:30,sm:35,md:40,lg:50,xl:60},Kt={...Ce,...Pe,...nt,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},zt=["update:modelValue"];function Nt(e,t){const{props:n,slots:r,emit:l,proxy:a}=_e(),{$q:c}=a,s=Ie(n,c),o=j(null),{refocusTargetEl:S,refocusTarget:d}=Ht(n,o),m=Be(n,At),$=w(()=>n.val!==void 0&&Array.isArray(n.modelValue)),x=w(()=>{const D=U(n.val);return $.value===!0?n.modelValue.findIndex(R=>U(R)===D):-1}),M=w(()=>$.value===!0?x.value>-1:U(n.modelValue)===U(n.trueValue)),y=w(()=>$.value===!0?x.value===-1:U(n.modelValue)===U(n.falseValue)),I=w(()=>M.value===!1&&y.value===!1),k=w(()=>n.disable===!0?-1:n.tabindex||0),K=w(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(n.disable===!0?" disabled":"")+(s.value===!0?` q-${e}--dark`:"")+(n.dense===!0?` q-${e}--dense`:"")+(n.leftLabel===!0?" reverse":"")),B=w(()=>{const D=M.value===!0?"truthy":y.value===!0?"falsy":"indet",R=n.color!==void 0&&(n.keepColor===!0||(e==="toggle"?M.value===!0:y.value!==!0))?` text-${n.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${D}${R}`}),v=w(()=>{const D={type:"checkbox"};return n.name!==void 0&&Object.assign(D,{".checked":M.value,"^checked":M.value===!0?"checked":void 0,name:n.name,value:$.value===!0?n.val:n.trueValue}),D}),C=rt(v),q=w(()=>{const D={tabindex:k.value,role:e==="toggle"?"switch":"checkbox","aria-label":n.label,"aria-checked":I.value===!0?"mixed":M.value===!0?"true":"false"};return n.disable===!0&&(D["aria-disabled"]="true"),D});function z(D){D!==void 0&&(te(D),d(D)),n.disable!==!0&&l("update:modelValue",N(),D)}function N(){if($.value===!0){if(M.value===!0){const D=n.modelValue.slice();return D.splice(x.value,1),D}return n.modelValue.concat([n.val])}if(M.value===!0){if(n.toggleOrder!=="ft"||n.toggleIndeterminate===!1)return n.falseValue}else if(y.value===!0){if(n.toggleOrder==="ft"||n.toggleIndeterminate===!1)return n.trueValue}else return n.toggleOrder!=="ft"?n.trueValue:n.falseValue;return n.indeterminateValue}function h(D){(D.keyCode===13||D.keyCode===32)&&te(D)}function T(D){(D.keyCode===13||D.keyCode===32)&&z(D)}const O=t(M,I);return Object.assign(a,{toggle:z}),()=>{const D=O();n.disable!==!0&&C(D,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const R=[Y("div",{class:B.value,style:m.value,"aria-hidden":"true"},D)];S.value!==null&&R.push(S.value);const L=n.label!==void 0?Qe(r.default,[n.label]):We(r.default);return L!==void 0&&R.push(Y("div",{class:`q-${e}__label q-anchor--skip`},L)),Y("div",{ref:o,class:K.value,...q.value,onClick:z,onKeydown:h,onKeyup:T},R)}}const Lt=Y("div",{key:"svg",class:"q-checkbox__bg absolute"},[Y("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[Y("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),Y("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Vt=he({name:"QCheckbox",props:Kt,emits:zt,setup(e){function t(n,r){const l=w(()=>(n.value===!0?e.checkedIcon:r.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>l.value!==null?[Y("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[Y(se,{class:"q-checkbox__icon",name:l.value})])]:[Lt]}return Nt("checkbox",t)}}),Rt=["none","strict","leaf","leaf-filtered"],Wt=he({name:"QTree",props:{...Ce,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>Rt.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:t,emit:n}){const{proxy:r}=_e(),{$q:l}=r,a=Ie(e,l),c=j({}),s=j(e.ticked||[]),o=j(e.expanded||[]);let S={};Ue(()=>{S={}});const d=w(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(a.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),m=w(()=>e.selected!==void 0),$=w(()=>e.icon||l.iconSet.tree.icon),x=w(()=>e.controlColor||e.color),M=w(()=>e.textColor!==void 0?` text-${e.textColor}`:""),y=w(()=>{const u=e.selectedColor||e.color;return u?` text-${u}`:""}),I=w(()=>e.filterMethod!==void 0?e.filterMethod:(u,f)=>{const i=f.toLowerCase();return u[e.labelKey]&&u[e.labelKey].toLowerCase().indexOf(i)>-1}),k=w(()=>{const u={},f=(i,b)=>{const g=i.tickStrategy||(b?b.tickStrategy:e.tickStrategy),_=i[e.nodeKey],F=i[e.childrenKey]&&Array.isArray(i[e.childrenKey])&&i[e.childrenKey].length!==0,W=i.disabled!==!0&&m.value===!0&&i.selectable!==!1,V=i.disabled!==!0&&i.expandable!==!1,Ne=g!=="none",J=g==="strict",De=g==="leaf-filtered",re=g==="leaf"||g==="leaf-filtered";let ae=i.disabled!==!0&&i.tickable!==!1;re===!0&&ae===!0&&b&&b.tickable!==!0&&(ae=!1);let P=i.lazy;P===!0&&c.value[_]!==void 0&&Array.isArray(i[e.childrenKey])===!0&&(P=c.value[_]);const p={key:_,parent:b,isParent:F,lazy:P,disabled:i.disabled,link:i.disabled!==!0&&(W===!0||V===!0&&(F===!0||P===!0)),children:[],matchesFilter:e.filter?I.value(i,e.filter):!0,selected:_===e.selected&&W===!0,selectable:W,expanded:F===!0?o.value.includes(_):!1,expandable:V,noTick:i.noTick===!0||J!==!0&&P&&P!=="loaded",tickable:ae,tickStrategy:g,hasTicking:Ne,strictTicking:J,leafFilteredTicking:De,leafTicking:re,ticked:J===!0?s.value.includes(_):F===!0?!1:s.value.includes(_)};if(u[_]=p,F===!0&&(p.children=i[e.childrenKey].map(A=>f(A,p)),e.filter&&(p.matchesFilter!==!0?p.matchesFilter=p.children.some(A=>A.matchesFilter):p.noTick!==!0&&p.disabled!==!0&&p.tickable===!0&&De===!0&&p.children.every(A=>A.matchesFilter!==!0||A.noTick===!0||A.tickable!==!0)===!0&&(p.tickable=!1)),p.matchesFilter===!0&&(p.noTick!==!0&&J!==!0&&p.children.every(A=>A.noTick)===!0&&(p.noTick=!0),re))){if(p.ticked=!1,p.indeterminate=p.children.some(A=>A.indeterminate===!0),p.tickable=p.tickable===!0&&p.children.some(A=>A.tickable),p.indeterminate!==!0){const A=p.children.reduce((be,Le)=>Le.ticked===!0?be+1:be,0);A===p.children.length?p.ticked=!0:A>0&&(p.indeterminate=!0)}p.indeterminate===!0&&(p.indeterminateNextState=p.children.every(A=>A.tickable!==!0||A.ticked!==!0))}return p};return e.nodes.forEach(i=>f(i,null)),u});ue(()=>e.ticked,u=>{s.value=u}),ue(()=>e.expanded,u=>{o.value=u});function K(u){const f=[].reduce,i=(b,g)=>{if(b||!g)return b;if(Array.isArray(g)===!0)return f.call(Object(g),i,b);if(g[e.nodeKey]===u)return g;if(g[e.childrenKey])return i(null,g[e.childrenKey])};return i(null,e.nodes)}function B(){return s.value.map(u=>K(u))}function v(){return o.value.map(u=>K(u))}function C(u){return u&&k.value[u]?k.value[u].expanded:!1}function q(){e.expanded!==void 0?n("update:expanded",[]):o.value=[]}function z(){const u=[],f=i=>{i[e.childrenKey]&&i[e.childrenKey].length!==0&&i.expandable!==!1&&i.disabled!==!0&&(u.push(i[e.nodeKey]),i[e.childrenKey].forEach(f))};e.nodes.forEach(f),e.expanded!==void 0?n("update:expanded",u):o.value=u}function N(u,f,i=K(u),b=k.value[u]){if(b.lazy&&b.lazy!=="loaded"){if(b.lazy==="loading")return;c.value[u]="loading",Array.isArray(i[e.childrenKey])!==!0&&(i[e.childrenKey]=[]),n("lazyLoad",{node:i,key:u,done:g=>{c.value[u]="loaded",i[e.childrenKey]=Array.isArray(g)===!0?g:[],Xe(()=>{const _=k.value[u];_&&_.isParent===!0&&h(u,!0)})},fail:()=>{delete c.value[u],i[e.childrenKey].length===0&&delete i[e.childrenKey]}})}else b.isParent===!0&&b.expandable===!0&&h(u,f)}function h(u,f){let i=o.value;const b=e.expanded!==void 0;if(b===!0&&(i=i.slice()),f){if(e.accordion&&k.value[u]){const g=[];k.value[u].parent?k.value[u].parent.children.forEach(_=>{_.key!==u&&_.expandable===!0&&g.push(_.key)}):e.nodes.forEach(_=>{const F=_[e.nodeKey];F!==u&&g.push(F)}),g.length!==0&&(i=i.filter(_=>g.includes(_)===!1))}i=i.concat([u]).filter((g,_,F)=>F.indexOf(g)===_)}else i=i.filter(g=>g!==u);b===!0?n("update:expanded",i):o.value=i}function T(u){return u&&k.value[u]?k.value[u].ticked:!1}function O(u,f){let i=s.value;const b=e.ticked!==void 0;b===!0&&(i=i.slice()),f?i=i.concat(u).filter((g,_,F)=>F.indexOf(g)===_):i=i.filter(g=>u.includes(g)===!1),b===!0&&n("update:ticked",i)}function D(u,f,i){const b={tree:r,node:u,key:i,color:e.color,dark:a.value};return Me(b,"expanded",()=>f.expanded,g=>{g!==f.expanded&&N(i,g)}),Me(b,"ticked",()=>f.ticked,g=>{g!==f.ticked&&O([i],g)}),b}function R(u){return(e.filter?u.filter(f=>k.value[f[e.nodeKey]].matchesFilter):u).map(f=>Ke(f))}function L(u){if(u.icon!==void 0)return Y(se,{class:"q-tree__icon q-mr-sm",name:u.icon,color:u.iconColor});const f=u.img||u.avatar;if(f)return Y("img",{class:`q-tree__${u.img?"img":"avatar"} q-mr-sm`,src:f})}function X(){n("afterShow")}function Q(){n("afterHide")}function Ke(u){const f=u[e.nodeKey],i=k.value[f],b=u.header&&t[`header-${u.header}`]||t["default-header"],g=i.isParent===!0?R(u[e.childrenKey]):[],_=g.length!==0||i.lazy&&i.lazy!=="loaded";let F=u.body&&t[`body-${u.body}`]||t["default-body"];const W=b!==void 0||F!==void 0?D(u,i,f):null;return F!==void 0&&(F=Y("div",{class:"q-tree__node-body relative-position"},[Y("div",{class:M.value},[F(W)])])),Y("div",{key:f,class:`q-tree__node relative-position q-tree__node--${_===!0?"parent":"child"}`},[Y("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(i.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(i.selected===!0?" q-tree__node--selected":"")+(i.disabled===!0?" q-tree__node--disabled":""),tabindex:i.link===!0?0:-1,onClick:V=>{me(u,i,V)},onKeypress(V){Je(V)!==!0&&(V.keyCode===13?me(u,i,V,!0):V.keyCode===32&&ne(u,i,V,!0))}},[Y("div",{class:"q-focus-helper",tabindex:-1,ref:V=>{S[i.key]=V}}),i.lazy==="loading"?Y(Ge,{class:"q-tree__spinner",color:x.value}):_===!0?Y(se,{class:"q-tree__arrow"+(i.expanded===!0?" q-tree__arrow--rotate":""),name:$.value,onClick(V){ne(u,i,V)}}):null,i.hasTicking===!0&&i.noTick!==!0?Y(Vt,{class:"q-tree__tickbox",modelValue:i.indeterminate===!0?null:i.ticked,color:x.value,dark:a.value,dense:!0,keepColor:!0,disable:i.tickable!==!0,onKeydown:te,"onUpdate:modelValue":V=>{ze(i,V)}}):null,Y("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(i.selected===!0?y.value:M.value)},[b?b(W):[L(u),Y("div",u[e.labelKey])]])]),_===!0?e.noTransition===!0?Y("div",{class:"q-tree__node-collapsible"+M.value,key:`${f}__q`},[F,Y("div",{class:"q-tree__children"+(i.disabled===!0?" q-tree__node--disabled":"")},i.expanded?g:null)]):Y(at,{duration:e.duration,onShow:X,onHide:Q},()=>et(Y("div",{class:"q-tree__node-collapsible"+M.value,key:`${f}__q`},[F,Y("div",{class:"q-tree__children"+(i.disabled===!0?" q-tree__node--disabled":"")},g)]),[[tt,i.expanded]])):F])}function ye(u){const f=S[u];f&&f.focus()}function me(u,f,i,b){b!==!0&&f.selectable!==!1&&ye(f.key),m.value&&f.selectable?e.noSelectionUnset===!1?n("update:selected",f.key!==e.selected?f.key:null):f.key!==e.selected&&n("update:selected",f.key===void 0?null:f.key):ne(u,f,i,b),typeof u.handler=="function"&&u.handler(u)}function ne(u,f,i,b){i!==void 0&&te(i),b!==!0&&f.selectable!==!1&&ye(f.key),N(f.key,!f.expanded,u,f)}function ze(u,f){if(u.indeterminate===!0&&(f=u.indeterminateNextState),u.strictTicking)O([u.key],f);else if(u.leafTicking){const i=[],b=g=>{g.isParent?(f!==!0&&g.noTick!==!0&&g.tickable===!0&&i.push(g.key),g.leafTicking===!0&&g.children.forEach(b)):g.noTick!==!0&&g.tickable===!0&&(g.leafFilteredTicking!==!0||g.matchesFilter===!0)&&i.push(g.key)};b(u),O(i,f)}}return e.defaultExpandAll===!0&&z(),Object.assign(r,{getNodeByKey:K,getTickedNodes:B,getExpandedNodes:v,isExpanded:C,collapseAll:q,expandAll:z,setExpanded:N,isTicked:T,setTicked:O}),()=>{const u=R(e.nodes);return Y("div",{class:d.value},u.length===0?e.filter?e.noResultsLabel||l.lang.tree.noResults:e.noNodesLabel||l.lang.tree.noNodes:u)}}});export{Vt as Q,Et as a,Qt as b,Wt as c,E as d,at as e,Kt as f,zt as g,Nt as h,Ft as u};
